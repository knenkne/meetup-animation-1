{"version":3,"file":"tabs.js","sources":["../../src/tabs/tabs.jsx"],"sourcesContent":["import React, { useState, useMemo, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\n\nimport { Tab } from './tab'\nimport { Header } from './header'\nimport { TabsStyled, TabsContentSectionStyled } from './tabs.style'\nimport { getFirstChildTitle, useUpdateEffect } from './tab-utils'\n\nconst KEYS = {\n    35: 'end',\n    36: 'home',\n    37: 'left',\n    39: 'right'\n}\n\nconst DIRECTIONS = {\n    37: -1,\n    39: 1\n}\n\n/**\n * [Zeplin](https://app.zeplin.io/project/5c74ef0d753f3ebccdf8f33d/screen/5cab79d394299816a9a8595d)\n * Компонент параллельного отображения блоков верстки\n *\n * @param {Object} props - свойства компонента\n * @return {JSX} - компонент\n */\nexport const Tabs = ({\n    children,\n    initialValue,\n    onChange,\n    size,\n    selectedItem,\n    onSelect,\n    ...rest\n}) => {\n    const parentId = useMemo(() => _.uniqueId('tab-wrapper-'), [])\n    const tabsId = useMemo(() => _.uniqueId('tabs-'), [])\n    const childrenArray = useMemo(() => React.Children.toArray(children))\n\n    const refs = useMemo(() => childrenArray.reduce((acc, child) => ({\n        ...acc,\n        [child.props?.title]: React.createRef()\n    }), {}), [children])\n\n    const { current: isControlled } = React.useRef(Boolean(selectedItem))\n    const [selectedTitle, setSelectedTitle] = useState(\n        isControlled\n            ? selectedItem\n            : initialValue || getFirstChildTitle(children)\n    )\n    const selectedTabTitle = isControlled ? selectedItem : selectedTitle\n\n    const selectedTabChild = useMemo(() => {\n        const properChild = childrenArray.find((child) => child.props?.title === selectedTabTitle)\n\n        return properChild?.props.children\n    })\n\n    const handleChange = useCallback(\n        (value) => isControlled ? onSelect(value) : setSelectedTitle(value),\n        [selectedTitle, selectedItem]\n    )\n\n    const focusTab = (title) => {\n        refs[title].current.focus()\n        handleChange(title)\n    }\n\n    // Either focus the next, previous, first, or last tab depening on key pressed\n    const handleKeyDown = (event) => {\n        const pressed = KEYS[event.keyCode]\n        const direction = DIRECTIONS[event.keyCode]\n\n        if (pressed) {\n            event.preventDefault()\n\n            if (pressed === 'end') {\n                focusTab(_.last(Object.keys(refs)))\n                return\n            }\n\n            if (pressed === 'home') {\n                focusTab(_.first(Object.keys(refs)))\n                return\n            }\n\n            const currentTabIndex = childrenArray.findIndex((child) => child.props?.title === selectedTabTitle)\n            const nextTitle = childrenArray[currentTabIndex + direction]?.props?.title\n\n            if (nextTitle) {\n                focusTab(nextTitle)\n            } else if (pressed === 'left') {\n                focusTab(_.last(Object.keys(refs)))\n            } else {\n                focusTab(_.first(Object.keys(refs)))\n            }\n        }\n    }\n\n    useUpdateEffect(() => {\n        onChange(selectedTitle)\n    }, [selectedTitle, selectedItem])\n\n    const mapChildren = () =>\n        childrenArray.map((child) => React.cloneElement(child, {\n            forceOpened: child.props?.title === selectedTabTitle,\n            id: tabsId,\n            onChange: handleChange,\n            onKeyDown: handleKeyDown,\n            parentId,\n            size,\n            ref: refs[child.props.title]\n        }))\n\n    return (\n        <TabsStyled aria-live=\"polite\">\n            <Header parentId={parentId} {...rest}>\n                <div role=\"tablist\">\n                    {mapChildren()}\n                </div>\n            </Header>\n            {!!selectedTabChild && <TabsContentSectionStyled\n                id={`panel-${tabsId}`}\n                role=\"tabpanel\"\n                aria-labelledby={`tab-${tabsId}`}\n                key={selectedTitle}\n                tabIndex=\"0\"\n            >\n                {selectedTabChild}\n            </TabsContentSectionStyled>}\n        </TabsStyled>\n    )\n}\n\nTabs.propTypes = {\n    onChange: PropTypes.func,\n    selectedItem: PropTypes.string,\n    onSelect: PropTypes.func,\n    initialValue: PropTypes.string,\n    children: PropTypes.node,\n    size: PropTypes.oneOf(['sm', 'md', 'lg']),\n    sticky: PropTypes.bool,\n    fullWidth: PropTypes.bool,\n    borderless: PropTypes.bool,\n}\n\nTabs.defaultProps = {\n    onChange: _.noop,\n    selectedItem: void 0,\n    onSelect: _.noop,\n    initialValue: void 0,\n    children: void 0,\n    size: 'md',\n    sticky: false,\n    fullWidth: false,\n    borderless: false,\n}\n\nTabs.Tab = Tab\nTabs.displayName = 'Tabs'\n"],"names":["KEYS","DIRECTIONS","Tabs","children","initialValue","onChange","size","selectedItem","onSelect","rest","parentId","useMemo","_","uniqueId","tabsId","childrenArray","React","Children","toArray","refs","reduce","acc","child","props","title","createRef","useRef","Boolean","isControlled","current","useState","getFirstChildTitle","selectedTitle","setSelectedTitle","selectedTabTitle","selectedTabChild","properChild","find","handleChange","useCallback","value","focusTab","focus","handleKeyDown","event","pressed","keyCode","direction","preventDefault","last","Object","keys","first","currentTabIndex","findIndex","nextTitle","useUpdateEffect","mapChildren","map","cloneElement","forceOpened","id","onKeyDown","ref","propTypes","PropTypes","func","string","node","oneOf","sticky","bool","fullWidth","borderless","defaultProps","noop","Tab","displayName"],"mappings":"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"}