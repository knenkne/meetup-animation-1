{"version":3,"file":"combobox-view.js","sources":["../../src/combobox/combobox-view.jsx"],"sourcesContent":["/* eslint-disable valid-jsdoc */\nimport React, { Fragment, Component } from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\nimport cs from 'classnames'\n\nimport { Input } from '../input'\nimport { memoizeFuncWithArgs, autoTopCheckByWindow } from '../utils'\nimport { prevItem, nextItem, keyCodes } from '../listbox/utils'\nimport { Perimeter } from '../perimeter'\nimport { Loader } from '../loader'\nimport { Icon } from '../icon'\n\nimport { autoScroll } from './utils'\nimport theme from './combobox.css'\nimport { Long } from './long'\nimport { Error } from './error'\nimport { NoMatches } from './no-matches'\n\n/**\n * Семантическое текстовое поле с выпадающим списком\n *\n * @param {Object} props - свойства компонента\n * @return {JSX} - компонент\n */\nexport class ComboboxView extends Component {\n    static propTypes = {\n        id: PropTypes.string,\n        placeholder: PropTypes.string,\n        isLoading: PropTypes.bool,\n        onChange: PropTypes.func,\n        onChangeInput: PropTypes.func,\n        onChangeOption: PropTypes.func,\n        onOpen: PropTypes.func,\n        onClose: PropTypes.func,\n        onRetry: PropTypes.func,\n        onScroll: PropTypes.func,\n        onBlur: PropTypes.func,\n        onFocus: PropTypes.func,\n        disabled: PropTypes.bool,\n        initialValue: PropTypes.string,\n        /**\n         * Первоначальный state.query\n         */\n        initialQuery: PropTypes.string,\n        /**\n         * Справочник подстановки\n         */\n        options: PropTypes.arrayOf(PropTypes.shape({\n            title: PropTypes.string,\n            description: PropTypes.string,\n            value: PropTypes.string.isRequired,\n            icon: PropTypes.string\n        })),\n        /**\n         * Вертикальное выравнивание Content относительно Target\n         */\n        verticalAlign: PropTypes.oneOfType([\n            PropTypes.func,\n            PropTypes.oneOf(['top', 'bottom'])\n        ]),\n        /**\n         * Статус загрузки данных (noMatches - нет совпадений, error - ошибка загрузки, long - долгая загрузка, off - справочник не предоставляется)\n         */\n        requestMode: PropTypes.oneOf(['noMatches', 'error', 'long']),\n        /**\n         * Тект для обработки случаев: не найдено совпадений, долгая загрузка, ошибка загрузки, повторить загрузку\n         */\n        translations: PropTypes.shape({\n            requestTimeout: PropTypes.string,\n            noMatches: PropTypes.string,\n            repeat: PropTypes.string,\n            requestError: PropTypes.string\n        }),\n        a11y: PropTypes.shape({\n            optionsLabel: PropTypes.string.isRequired,\n        }).isRequired,\n        error: PropTypes.string,\n    }\n\n    static defaultProps = {\n        initialQuery: void 0,\n        initialValue: void 0,\n        onChange: _.noop,\n        onChangeInput: _.noop,\n        onChangeOption: _.noop,\n        id: void 0,\n        options: [],\n        onOpen: _.noop,\n        onClose: _.noop,\n        onScroll: _.noop,\n        onBlur: _.noop,\n        onFocus: _.noop,\n        verticalAlign: autoTopCheckByWindow,\n        mode: 'on',\n        requestMode: void 0,\n        placeholder: void 0,\n        isLoading: false,\n        onRetry: _.noop,\n        translations: {\n            requestTimeout: void 0,\n            noMatches: void 0,\n            repeat: void 0,\n            requestError: void 0\n        },\n        error: '',\n        disabled: false,\n    }\n\n    constructor (props) {\n        super(props)\n\n        const query = props.initialQuery || _.find(\n            props.options,\n            (option) => option?.value === props.initialValue\n        )?.title || props.initialValue || ''\n\n        this.state = {\n            expanded: false,\n            activeDescendant: props.initialValue,\n            query,\n            verticalAlign: 'bottom',\n        }\n\n        this.id = props.id || _.uniqueId('ui-combobox')\n        this.theme = theme\n    }\n\n    // eslint-disable-next-line babel/camelcase, comment: React UNSAFE method\n    UNSAFE_componentWillReceiveProps ({ options, value }) {\n        if (!_.find(options, (option) => option.value === this.state.activeDescendant)) {\n            this.setState({\n                activeDescendant: this.getActive(options)\n            })\n        }\n\n        if (this.props.value !== value) {\n            const title = _.find(options, (option) => option.value === value)?.title\n\n            this.setState({\n                activeDescendant: value,\n                query: title || value\n            })\n        }\n\n    }\n\n    componentDidUpdate (prevProps, prevState) {\n        const newAlign = prevProps.verticalAlign?.(this.content, this.target)\n        if (newAlign !== prevState.verticalAlign) {\n            this.setState({ verticalAlign: newAlign })\n        }\n    }\n\n    setWrapperRef = (node) => {\n        this.perimeter = node\n    }\n\n    setContentRef = (node) => {\n        const { verticalAlign } = this.props\n        this.content = node\n        this.setState({ verticalAlign: verticalAlign?.(this.content, this.target) })\n    }\n\n    setTargetRef = (node) => {\n        this.target = node\n    }\n\n    getActive = (options) => options?.length ? options[0].value : void 0\n\n    handleKeyDownTarget = (event) => {\n        switch (event.keyCode) {\n            case keyCodes.KEY_ESCAPE: {\n                event.preventDefault()\n                this.handleClear()\n                break\n            }\n            case keyCodes.KEY_ENTER: {\n                event.preventDefault()\n                const option = _.find(this.props.options, { value: this.state.activeDescendant })\n\n                if (option) {\n                    this.handleOptionChoose(option)\n                }\n                break\n            }\n            case keyCodes.KEY_ARROW_DOWN: {\n                event.preventDefault()\n                const nextOption = nextItem(this.props.options, this.state.activeDescendant)\n                if (nextOption) {\n                    this.handleOptionFocus(nextOption)\n                }\n                break\n            }\n            case keyCodes.KEY_ARROW_UP: {\n                event.preventDefault()\n                const nextOption = prevItem(this.props.options, this.state.activeDescendant)\n                if (nextOption) {\n                    this.handleOptionFocus(nextOption)\n                }\n                break\n            }\n            case keyCodes.KEY_HOME: {\n                event.preventDefault()\n                this.handleOptionFocus(_.first(this.props.options))\n                break\n            }\n            case keyCodes.KEY_END: {\n                event.preventDefault()\n                this.handleOptionFocus(_.last(this.props.options))\n                break\n            }\n\n            default: {\n                break\n            }\n        }\n    }\n\n    handleOpen = (e) => {\n        const prevExpanded = this.state.expanded\n        this.setState({\n            expanded: true\n        }, () => this.onHandling(prevExpanded, true))\n        if (this.props.onFocus) {\n            this.props.onFocus(e)\n        }\n    }\n\n    handleBlur = (e) => {\n        if (this.props.onBlur) {\n            this.props.onBlur(e)\n        }\n    }\n\n    handleClose = () => {\n        const prevExpanded = this.state.expanded\n        this.setState({\n            expanded: false\n        }, () => this.onHandling(prevExpanded, false))\n    }\n\n    handleOptionFocus = (option) => {\n        this.setState({\n            activeDescendant: option.value\n        }, () => autoScroll(\n            document.getElementById(`${this.id}-option-${this.state.activeDescendant}`),\n            this.content\n        ))\n    }\n\n    handleOptionChoose = (option) => {\n        this.props.onChangeOption(option.value, option.title)\n        this.props.onChange(option.value)\n        this.setState({\n            query: option.title,\n            activeDescendant: option.value,\n            expanded: false\n        })\n    }\n\n    handleInput = (e) => {\n        this.props.onChangeInput(e.target.value, e)\n        this.props.onChange(e.target.value, e)\n        this.setState({\n            query: e.target.value,\n            expanded: true\n        })\n    }\n\n    handleClear = () => {\n        this.props.onChangeInput('')\n        this.props.onChange('')\n        this.setState({\n            query: ''\n        })\n    }\n\n    onHandling = (prevState, nextState) => {\n        const { onOpen, onClose } = this.props\n        if (!prevState && nextState) {\n            this.perimeter.enableOnClickOutside()\n            onOpen()\n        } else if (prevState && !nextState) {\n            this.perimeter.disableOnClickOutside()\n            onClose()\n        }\n    }\n\n    isExpanded = () => !_.isEmpty(this.props.options) && this.state.expanded\n\n    isActiveDescendant = (option) => this.state.activeDescendant === option?.value\n\n    render () {\n        const { label, limit, onScroll } = this.props\n        const { verticalAlign } = this.state\n        const target = this.renderTarget()\n        const contents = this.renderContents()\n\n        return (\n            <Fragment>\n                {label && (\n                    <label htmlFor={this.id} className={this.theme.label}>\n                        {label}\n                    </label>\n                )}\n                <Perimeter disableOnClickOutside ref={this.setWrapperRef} onClickOutside={this.handleClose}>\n                    <div\n                        id={`${this.id}:combobox`}\n                        className={this.theme.combobox}\n                    >\n                        {target}\n                        {contents && (\n                            <div\n                                className={cs(this.theme.popup, this.theme[verticalAlign])}\n                                style={{ maxHeight: `${limit * 48}px`, overflowY: this.isExpanded() ? 'scroll' : 'hidden' }}\n                                ref={this.setContentRef}\n                                onScroll={onScroll}\n                            >\n                                {contents}\n                            </div>\n                        )}\n                    </div>\n                </Perimeter>\n            </Fragment>\n        )\n    }\n\n\n    renderTarget = () => (\n        <div\n            role=\"combobox\"\n            ref={this.setTargetRef}\n            aria-haspopup=\"listbox\"\n            aria-expanded={this.isExpanded()}\n            aria-owns={`${this.id}-contents`}\n        >\n            <Input\n                id={this.id}\n                type=\"text\"\n                value={this.state.query}\n                className={cs(\n                    this.theme.input,\n                    this.isExpanded() && this.theme.inputExpanded\n                )}\n                disabled={this.props.disabled}\n                placeholder={this.props.placeholder}\n                onChange={this.handleInput}\n                onFocus={this.handleOpen}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDownTarget}\n                error={this.props.error}\n                aria-activedescendant={`${this.id}-option-${this.state.activeDescendant}`}\n                aria-autocomplete=\"list\"\n            />\n        </div>\n    )\n\n    // eslint-disable-next-line complexity, comment: complexity of 13\n    renderContents = () => {\n        const {\n            isLoading, onRetry, requestMode, options, a11y, translations: {\n                requestTimeout,\n                repeat,\n                noMatches,\n                requestError,\n            }\n        } = this.props\n        const { expanded } = this.state\n\n        return (\n            <div>\n                {this.isExpanded() && (\n                    <ul\n                        id={`${this.id}-contents`}\n                        className={this.theme.list}\n                        role=\"listbox\"\n                        tabIndex={-1}\n                        aria-label={a11y?.optionsLabel}\n                    >\n                        {_.map(options, this.renderOption)}\n                    </ul>\n                )}\n                {requestMode !== 'long' && isLoading && (\n                    <div className={this.theme.loading}>\n                        <Loader.Button\n                            size=\"sm\"\n                            colorScheme=\"dark\"\n                        />\n                    </div>\n                )}\n                {requestMode === 'long' && expanded && requestTimeout && (\n                    <Long\n                        className={this.theme.additionalInfo}\n                        onClick={onRetry}\n                        title={repeat}\n                        aria-label={requestTimeout}\n                    >\n                        {requestTimeout}\n                    </Long>\n                )}\n                {requestMode === 'error' && expanded && requestError && (\n                    <Error\n                        className={this.theme.additionalInfo}\n                        onClick={onRetry}\n                        title={repeat}\n                        aria-label={requestError}\n                    >\n                        {requestError}\n                    </Error>\n                )}\n                {requestMode === 'noMatches' && expanded && noMatches && (\n                    <NoMatches\n                        className={this.theme.additionalInfo}\n                        aria-label={noMatches}\n                    >\n                        {noMatches}\n                    </NoMatches>\n                )}\n            </div>\n        )\n    }\n\n\n    renderOption = (option) => {\n        const activeDescendant = this.isActiveDescendant(option)\n        return (\n            <li\n                key={option.value}\n                id={`${this.id}-option-${option.value}`}\n                className={cs(\n                    this.theme.option,\n                    activeDescendant && this.theme.focused\n                )}\n                onClick={memoizeFuncWithArgs(this.handleOptionChoose, option)}\n                role=\"option\"\n                aria-selected={activeDescendant}\n            >\n                {option.icon && (\n                    option.fromCode ? (\n                        <Icon name={option.icon} theme={{ icon: cs(Icon.theme.icon, this.theme.optionIcon) }} />\n                    ) : (\n                        <img alt={option.value} src={option.icon} className={this.theme.optionIcon} />\n                    )\n                )}\n                {option.children && (\n                    <span className={this.theme.optionIcon}>\n                        {option.children}\n                    </span>\n                )}\n                <span className={this.theme.optionTitle}>{option.title}</span>\n                {option.description && (\n                    <span className={this.theme.optionDescription}>\n                        {option.description}\n                    </span>\n                )}\n                {option.additional && (\n                    <span className={this.theme.optionAside}>\n                        {option.additional}\n                    </span>\n                )}\n            </li>\n        )\n    }\n\n}\n\nComboboxView.displayName = 'Combobox.View'\n\nexport default ComboboxView\n"],"names":["ComboboxView","props","node","perimeter","verticalAlign","content","setState","target","options","length","value","event","keyCode","keyCodes","KEY_ESCAPE","preventDefault","handleClear","KEY_ENTER","option","_","find","state","activeDescendant","handleOptionChoose","KEY_ARROW_DOWN","nextOption","nextItem","handleOptionFocus","KEY_ARROW_UP","prevItem","KEY_HOME","first","KEY_END","last","e","prevExpanded","expanded","onHandling","onFocus","onBlur","autoScroll","document","getElementById","id","onChangeOption","title","onChange","query","onChangeInput","prevState","nextState","onOpen","onClose","enableOnClickOutside","disableOnClickOutside","isEmpty","setTargetRef","isExpanded","cs","theme","input","inputExpanded","disabled","placeholder","handleInput","handleOpen","handleBlur","handleKeyDownTarget","error","isLoading","onRetry","requestMode","a11y","translations","requestTimeout","repeat","noMatches","requestError","list","optionsLabel","map","renderOption","loading","additionalInfo","isActiveDescendant","focused","memoizeFuncWithArgs","icon","fromCode","Icon","optionIcon","children","optionTitle","description","optionDescription","additional","optionAside","initialQuery","initialValue","uniqueId","getActive","prevProps","newAlign","label","limit","onScroll","renderTarget","contents","renderContents","setWrapperRef","handleClose","combobox","popup","maxHeight","overflowY","setContentRef","Component","PropTypes","string","bool","func","arrayOf","shape","isRequired","oneOfType","oneOf","noop","autoTopCheckByWindow","mode","displayName"],"mappings":"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"}