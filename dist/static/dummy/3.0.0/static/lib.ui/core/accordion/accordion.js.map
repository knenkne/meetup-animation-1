{"version":3,"file":"accordion.js","sources":["../../src/accordion/accordion.jsx"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\n\nimport { Item } from './item'\nimport defaultTheme from './style.css'\n\nconst omitProps = ['initialValue', 'a11y', 'collapsible', 'theme']\n\nexport const cyclicPrevItem = (list, item) => (_.indexOf(list, item) - 1 + list.length) % list.length\nexport const cyclicNextItem = (list, item) => (_.indexOf(list, item) + 1) % list.length\n\nconst KEY_ARROW_UP = 38\nconst KEY_ARROW_DOWN = 40\nconst KEY_END = 35\nconst KEY_HOME = 36\n\n// eslint-disable-next-line valid-jsdoc, comment: Zeplin link, args in proptypes\n/**\n * [Zeplin](https://app.zeplin.io/project/5c74ef0d753f3ebccdf8f33d/screen/5ca74b09e32f16b878d864a6)\n * Cписок с раскрывающимся содержимым.\n */\nexport class Accordion extends React.PureComponent {\n\n    static hasNoDescription = (children) => children.every((child) => !child.props.description)\n\n    state = {\n        active: this.props.initialValue,\n    }\n\n    handleChange = (active, event) => {\n        const currentActive = this.state.active === active ? void 0 : active\n        this.setState({ active: currentActive })\n        this.props.onChange(currentActive, event)\n    }\n\n    handleKeyDown = (title, event) => {\n        const options = React.Children.map(this.props.children, (child) => child.props.title)\n\n        switch (event.keyCode) {\n            case KEY_ARROW_DOWN: {\n                event.preventDefault()\n                this.focus(cyclicNextItem(options, title))\n                break\n            }\n            case KEY_ARROW_UP: {\n                event.preventDefault()\n                this.focus(cyclicPrevItem(options, title))\n                break\n            }\n            case KEY_HOME: {\n                event.preventDefault()\n                this.focus(0)\n                break\n            }\n            case KEY_END: {\n                event.preventDefault()\n                this.focus(options.length - 1)\n                break\n            }\n\n            default: {\n                break\n            }\n        }\n\n        this.props.onKeyDown(event)\n    }\n\n    focus (newIndex) {\n        const newItem = document.getElementById(`${this.props.a11y.id}-${newIndex}-title`)\n\n        if (newItem) {\n            newItem.focus()\n        }\n    }\n\n    render () {\n        const { mode, theme } = this.props\n        return (\n            <div\n                {..._.omit(this.props, omitProps)}\n                className={theme[`accordion-${mode}`]}\n                role=\"presentation\"\n            >\n                {React.Children.map(this.props.children, this.renderChild)}\n            </div>\n        )\n    }\n\n    renderChild = (child, index) => {\n        const { mode, collapsible } = this.props\n\n        return (\n            React.cloneElement(child, _.extend({}, child.props, {\n                forceOpened: this.state.active === child.props.title,\n                mode,\n                collapsible,\n                onChange: this.handleChange,\n                onKeyDown: this.handleKeyDown,\n                id: `${this.props.a11y.id}-${index}`,\n            }))\n        )\n    }\n}\n\nAccordion.propTypes = {\n    initialValue: PropTypes.string,\n    children: PropTypes.node.isRequired,\n    a11y: PropTypes.shape({\n        id: PropTypes.string\n    }).isRequired,\n    onChange: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    mode: PropTypes.oneOf(['widget', 'info', 'description', 'classic']),\n    /**\n     * Если нужно держать открытыми несколько блоков\n     */\n    collapsible: PropTypes.bool,\n    theme: PropTypes.object\n}\n\nAccordion.defaultProps = {\n    initialValue: void 0,\n    onChange: _.noop,\n    onKeyDown: _.noop,\n    collapsible: false,\n    mode: 'classic',\n    theme: defaultTheme\n}\n\nAccordion.displayName = 'Accordion'\nAccordion.Item = Item\nAccordion.theme = defaultTheme\n\nexport default Accordion\n"],"names":["omitProps","cyclicPrevItem","list","item","_","indexOf","length","cyclicNextItem","KEY_ARROW_UP","KEY_ARROW_DOWN","KEY_END","KEY_HOME","Accordion","active","props","initialValue","event","currentActive","state","setState","onChange","title","options","React","Children","map","children","child","keyCode","preventDefault","focus","onKeyDown","index","mode","collapsible","cloneElement","extend","forceOpened","handleChange","handleKeyDown","id","a11y","newIndex","newItem","document","getElementById","theme","omit","renderChild","PureComponent","every","description","propTypes","PropTypes","string","node","isRequired","shape","func","oneOf","bool","object","defaultProps","noop","defaultTheme","displayName","Item"],"mappings":"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"}