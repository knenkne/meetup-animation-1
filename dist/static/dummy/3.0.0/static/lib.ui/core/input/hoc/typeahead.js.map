{"version":3,"file":"typeahead.js","sources":["../../../src/input/hoc/typeahead.jsx"],"sourcesContent":["import React from 'react'\r\nimport _ from 'lodash'\r\nimport classnames from 'classnames'\r\n\r\nimport { getDisplayName } from '../../utils/get-display-name'\r\nimport { getExpectedWidth } from '../utils'\r\n\r\nimport style from './typeahead.css'\r\n\r\nconst omitFakeProps = ['id', 'name', 'icon', 'onBlur', 'onChange', 'onFocus']\r\nconst extendFakeProps = {\r\n    tabIndex: -1,\r\n    disabled: true,\r\n    'aria-hidden': true\r\n}\r\n\r\nconst extendNoValueFakeProps = {\r\n    value: '',\r\n    placeholder: void 0\r\n}\r\n\r\nconst moveSelection = (element, value) => {\r\n    // Фикс IE для сдвига курсора у фейкового поля (IE, игнорируя значения, оставляет курсор в нуле у полей, которые никогда не получали фокуса)\r\n    if (element) {\r\n        element.disabled = false // eslint-disable-line no-param-reassign, comment: для IE при сдвиге курсора надо выключать disabled\r\n        element.setSelectionRange(value.length, value.length)\r\n        element.disabled = true // eslint-disable-line no-param-reassign, comment: а потом снова включать его\r\n    }\r\n}\r\n\r\nconst isOverflow = (element) => element && (parseFloat(getExpectedWidth(element, 1)) > element.clientWidth)\r\n\r\nexport const typeaheadFactory = (propsMaker = _.identity, fakePropsMaker = _.identity) => (Component) => {\r\n    class Typeahead extends React.Component {\r\n        static propTypes = Component.propTypes\r\n        static defaultProps = Component.defaultProps\r\n        static displayName = getDisplayName(Component, 'TypeaheadComponent')\r\n        static WrappedComponent = Component\r\n\r\n        getWrapper = (c) => {\r\n            this.input = c\r\n            this.props.refWrapper(c, this.inputFake)\r\n        }\r\n\r\n        getWrapperFake = (c) => {\r\n            this.inputFake = c\r\n            moveSelection(this.inputFake, this.props.value)\r\n        }\r\n\r\n        render () {\r\n            const passedProps = propsMaker(this.props)\r\n            const passedFakeProps = _(fakePropsMaker(this.props))\r\n                .omit(omitFakeProps)\r\n                .extend(extendFakeProps, isOverflow(this.input) ? extendNoValueFakeProps : {})\r\n                .value()\r\n\r\n            return (\r\n                <div\r\n                    className={classnames(\r\n                        style.wrapper,\r\n                        this.props.disabled && style.disabled,\r\n                        this.props.error && style.error,\r\n                        this.props.active && style.focus\r\n                    )}\r\n                >\r\n                    <Component {...passedFakeProps} refWrapper={this.getWrapperFake} />\r\n                    <Component {...passedProps} refWrapper={this.getWrapper} />\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n\r\n    return Typeahead\r\n}\r\n"],"names":["omitFakeProps","extendFakeProps","tabIndex","disabled","extendNoValueFakeProps","value","placeholder","moveSelection","element","setSelectionRange","length","isOverflow","parseFloat","getExpectedWidth","clientWidth","typeaheadFactory","propsMaker","_","identity","fakePropsMaker","Component","Typeahead","c","input","props","refWrapper","inputFake","passedProps","passedFakeProps","omit","extend","classnames","style","wrapper","error","active","focus","getWrapperFake","getWrapper","React","propTypes","defaultProps","getDisplayName"],"mappings":"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"}