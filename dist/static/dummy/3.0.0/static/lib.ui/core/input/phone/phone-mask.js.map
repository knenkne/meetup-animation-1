{"version":3,"file":"phone-mask.js","sources":["../../../src/input/phone/phone-mask.js"],"sourcesContent":["import _ from 'lodash'\n\nconst EMPTY_STRING = ''\nconst defaultCodeLength = 3\nconst oneDigit = /\\d/\nconst maskDelimiter = '-'\nconst maskSpace = ' '\nconst maskStart = ['+', '7', maskSpace, '(', oneDigit]\nconst maskEnd = [\n    oneDigit, oneDigit, ')', maskSpace,\n    oneDigit, oneDigit, oneDigit, maskDelimiter,\n    oneDigit, oneDigit, maskDelimiter,\n    oneDigit, oneDigit\n]\nconst safeCodeLength = 5\n\nexport const calculateMask = (codeLength) => _.concat(\n    maskStart,\n    _.fill(new Array(codeLength - 1), oneDigit),\n    ')',\n    maskSpace,\n    _.drop(maskEnd, codeLength + (codeLength > safeCodeLength ? 2 : 1))\n)\n\nexport const recursiveCodeLength = (rawValue, suggest, codeLength, count = 0) => {\n    if (rawValue.length <= codeLength + count) {\n        return codeLength\n    }\n    if (_.indexOf(suggest, rawValue.slice(0, codeLength + count + 1)) !== -1) {\n        return codeLength + count + 1\n    }\n    return recursiveCodeLength(rawValue, suggest, codeLength, count + 1)\n}\n\nexport const unmaskedPhone = (value) => value.replace(/(^\\+7\\s|[\\s()+_-]*)/g, EMPTY_STRING)\n\nexport const trimPhoneRight = (value) => value.replace(/[\\s()_-]*$/, EMPTY_STRING)\n\nexport const phoneMask = (value, suggest) => calculateMask(recursiveCodeLength(unmaskedPhone(value), suggest, defaultCodeLength))\n"],"names":["EMPTY_STRING","defaultCodeLength","oneDigit","maskDelimiter","maskSpace","maskStart","maskEnd","safeCodeLength","calculateMask","codeLength","_","concat","fill","Array","drop","recursiveCodeLength","rawValue","suggest","count","length","indexOf","slice","unmaskedPhone","value","replace","trimPhoneRight","phoneMask"],"mappings":";;AAEA,IAAMA,YAAY,GAAG,EAArB;AACA,IAAMC,iBAAiB,GAAG,CAA1B;AACA,IAAMC,QAAQ,GAAG,IAAjB;AACA,IAAMC,aAAa,GAAG,GAAtB;AACA,IAAMC,SAAS,GAAG,GAAlB;AACA,IAAMC,SAAS,GAAG,CAAC,GAAD,EAAM,GAAN,EAAWD,SAAX,EAAsB,GAAtB,EAA2BF,QAA3B,CAAlB;AACA,IAAMI,OAAO,GAAG,CACZJ,QADY,EACFA,QADE,EACQ,GADR,EACaE,SADb,EAEZF,QAFY,EAEFA,QAFE,EAEQA,QAFR,EAEkBC,aAFlB,EAGZD,QAHY,EAGFA,QAHE,EAGQC,aAHR,EAIZD,QAJY,EAIFA,QAJE,CAAhB;AAMA,IAAMK,cAAc,GAAG,CAAvB;IAEaC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,UAAD;AAAA,SAAgBC,CAAC,CAACC,MAAF,CACzCN,SADyC,EAEzCK,CAAC,CAACE,IAAF,CAAO,IAAIC,KAAJ,CAAUJ,UAAU,GAAG,CAAvB,CAAP,EAAkCP,QAAlC,CAFyC,EAGzC,GAHyC,EAIzCE,SAJyC,EAKzCM,CAAC,CAACI,IAAF,CAAOR,OAAP,EAAgBG,UAAU,IAAIA,UAAU,GAAGF,cAAb,GAA8B,CAA9B,GAAkC,CAAtC,CAA1B,CALyC,CAAhB;AAAA;IAQhBQ,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,QAAD,EAAWC,OAAX,EAAoBR,UAApB,EAA8C;AAAA,MAAdS,KAAc,uEAAN,CAAM;;AAC7E,MAAIF,QAAQ,CAACG,MAAT,IAAmBV,UAAU,GAAGS,KAApC,EAA2C;AACvC,WAAOT,UAAP;AACH;;AACD,MAAIC,CAAC,CAACU,OAAF,CAAUH,OAAV,EAAmBD,QAAQ,CAACK,KAAT,CAAe,CAAf,EAAkBZ,UAAU,GAAGS,KAAb,GAAqB,CAAvC,CAAnB,MAAkE,CAAC,CAAvE,EAA0E;AACtE,WAAOT,UAAU,GAAGS,KAAb,GAAqB,CAA5B;AACH;;AACD,SAAOH,mBAAmB,CAACC,QAAD,EAAWC,OAAX,EAAoBR,UAApB,EAAgCS,KAAK,GAAG,CAAxC,CAA1B;AACH;IAEYI,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD;AAAA,SAAWA,KAAK,CAACC,OAAN,CAAc,sBAAd,EAAsCxB,YAAtC,CAAX;AAAA;IAEhByB,cAAc,GAAG,SAAjBA,cAAiB,CAACF,KAAD;AAAA,SAAWA,KAAK,CAACC,OAAN,CAAc,YAAd,EAA4BxB,YAA5B,CAAX;AAAA;IAEjB0B,SAAS,GAAG,SAAZA,SAAY,CAACH,KAAD,EAAQN,OAAR;AAAA,SAAoBT,aAAa,CAACO,mBAAmB,CAACO,aAAa,CAACC,KAAD,CAAd,EAAuBN,OAAvB,EAAgChB,iBAAhC,CAApB,CAAjC;AAAA;;;;"}