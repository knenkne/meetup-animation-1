{"version":3,"file":"utils.js","sources":["../../src/dropdown/utils.js"],"sourcesContent":["import _ from 'lodash'\r\n\r\nconst TOP = 'top'\r\nconst BOTTOM = 'bottom'\r\nconst LEFT = 'left'\r\nconst RIGHT = 'right'\r\n\r\nexport const autoLeftCheckByParent = (content, target) => {\r\n    if (content && target) {\r\n        const parentRight = target.parentNode.getBoundingClientRect().right\r\n        const targetLeft = target.getBoundingClientRect().left\r\n        const restWidth = parentRight - targetLeft\r\n        const freeWidth = restWidth - content.offsetWidth\r\n\r\n        return freeWidth < 0 ? RIGHT : LEFT\r\n    }\r\n\r\n    return LEFT\r\n}\r\n\r\nexport const autoLeftCheckByWindow = (content, target) => {\r\n    if (content && target) {\r\n        content.parentNode.style.left = '' // eslint-disable-line no-param-reassign, comment: предварительная очистка\r\n        content.parentNode.style.right = '' // eslint-disable-line no-param-reassign, comment: предварительная очистка\r\n        content.parentNode.style.maxWidth = '' // eslint-disable-line no-param-reassign, comment: предварительная очистка\r\n\r\n        const targetToRight = document.documentElement.clientWidth - target.getBoundingClientRect().left\r\n        const targetToLeft = target.getBoundingClientRect().right\r\n\r\n        const contentFullWidth = content.offsetWidth\r\n        const freeSpaceToRight = targetToRight - contentFullWidth\r\n        const freeSpaceToLeft = targetToLeft - contentFullWidth\r\n\r\n        if (freeSpaceToRight >= 0) {\r\n            return LEFT\r\n        } else if (freeSpaceToLeft >= 0 && freeSpaceToRight < 0) {\r\n            return RIGHT\r\n        } else if (contentFullWidth > document.documentElement.clientWidth) {\r\n            content.parentNode.style.left = `${target.offsetWidth - targetToLeft}px` // eslint-disable-line no-param-reassign, comment: компонент посчитает свое смещение\r\n            content.parentNode.style.maxWidth = `${document.documentElement.clientWidth}px` // eslint-disable-line no-param-reassign, comment: компонент поровняется с окном\r\n            return LEFT\r\n        } else if (freeSpaceToRight >= freeSpaceToLeft) {\r\n            content.parentNode.style.left = `${freeSpaceToRight}px` // eslint-disable-line no-param-reassign, comment: компонент посчитает свое смещение\r\n            return LEFT\r\n        }\r\n        content.parentNode.style.right = `${freeSpaceToLeft}px` // eslint-disable-line no-param-reassign, comment: компонент посчитает свое смещение\r\n        return RIGHT\r\n    }\r\n\r\n    return LEFT\r\n}\r\n\r\n/**\r\n * Функция, возвращающая true, если contextContent должен отобразиться вверх относительно contextTarget\r\n * Дополнительно задает максимальную высоту содержимому contextContent, если размеры окна не позволяют отобразиться элементу полностью\r\n * @param {Node} content - контент Dropdown\r\n * @param {Node} target - основной компонент Dropdown (обертка)\r\n * @return {Boolean} - contextContent должен отобразиться вверх относительно contextTarget\r\n */\r\nexport const autoTopCheckByWindow = (content, target) => {\r\n    if (content && target) {\r\n        content.firstChild.style.maxHeight = '' // eslint-disable-line no-param-reassign, comment: компонент посчитает свою высоту\r\n        content.firstChild.style.overflowY = '' // eslint-disable-line no-param-reassign, comment: компонент посчитает свою высоту\r\n\r\n        const targetBottom = target.getBoundingClientRect().bottom\r\n        const distanceToBottom = document.documentElement.clientHeight - targetBottom\r\n        const distanceToTop = target.getBoundingClientRect().top\r\n        const freeHeightToBottom = distanceToBottom - content.scrollHeight\r\n        const freeHeightToTop = distanceToTop - content.scrollHeight\r\n\r\n\r\n        if (freeHeightToBottom >= 0) {\r\n            return BOTTOM\r\n        } else if (freeHeightToBottom <= 0 && freeHeightToTop >= 0) {\r\n            return TOP\r\n        }\r\n\r\n        content.firstChild.style.maxHeight = `${_.max([distanceToBottom, distanceToTop])}px` // eslint-disable-line no-param-reassign, comment: компонент определит свою НОВУЮ высоту\r\n        content.firstChild.style.overflowY = 'scroll' // eslint-disable-line no-param-reassign, comment: и будет скроллиться, если надо\r\n\r\n        return freeHeightToTop >= freeHeightToBottom ? TOP : BOTTOM\r\n    }\r\n\r\n    return BOTTOM\r\n}\r\n\r\nexport const autoScroll = (node, contentPlate) => {\r\n    if (contentPlate && node) {\r\n        const elementPos = contentPlate.scrollTop + node.getBoundingClientRect().top - contentPlate.getBoundingClientRect().top\r\n        const height = contentPlate.clientHeight\r\n        const currentPos = contentPlate.scrollTop\r\n\r\n        if (!_.inRange(elementPos, currentPos, currentPos + height)) {\r\n            contentPlate.scrollTop = Math.abs(currentPos - elementPos) < Math.abs(currentPos + height - elementPos) ? elementPos : elementPos - height + node.clientHeight // eslint-disable-line no-param-reassign, comment: скролл по клавиатуре\r\n        } else if (!_.inRange(elementPos + node.clientHeight, currentPos, currentPos + height)) {\r\n            contentPlate.scrollTop = elementPos - height + node.clientHeight // eslint-disable-line no-param-reassign, comment: скролл по клавиатуре\r\n        }\r\n    }\r\n}\r\n\r\nexport const cyclicPrevItem = (list, item) => {\r\n    if (!item) {\r\n        return _.last(list)\r\n    }\r\n    return list[(_.indexOf(list, item) - 1 + list.length) % list.length]\r\n}\r\nexport const cyclicNextItem = (list, item) => {\r\n    if (!item) {\r\n        return _.first(list)\r\n    }\r\n    return list[(_.indexOf(list, item) + 1) % list.length]\r\n}\r\n"],"names":["TOP","BOTTOM","LEFT","RIGHT","autoLeftCheckByParent","content","target","parentRight","parentNode","getBoundingClientRect","right","targetLeft","left","restWidth","freeWidth","offsetWidth","autoLeftCheckByWindow","style","maxWidth","targetToRight","document","documentElement","clientWidth","targetToLeft","contentFullWidth","freeSpaceToRight","freeSpaceToLeft","autoTopCheckByWindow","firstChild","maxHeight","overflowY","targetBottom","bottom","distanceToBottom","clientHeight","distanceToTop","top","freeHeightToBottom","scrollHeight","freeHeightToTop","_","max","autoScroll","node","contentPlate","elementPos","scrollTop","height","currentPos","inRange","Math","abs","cyclicPrevItem","list","item","last","indexOf","length","cyclicNextItem","first"],"mappings":"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"}