{"version":3,"file":"month-input.js","sources":["../../../src/calendar/month-picker/month-input.jsx"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\nimport { format, isValid, toDate } from 'date-fns'\n\nimport { Input } from '../../input'\nimport { isTouchable } from '../../utils'\nimport { isMobileEnabled } from '../mobile-enabler'\nimport {\n    LOCALE,\n    EMPTY_STRING,\n    MASK_MONTH,\n    MONTH_FORMAT,\n    MONTH_AND_YEAR_PLACEHOLDER,\n    MASK_MONTH_INVALID\n} from '../constants'\nimport { dateStringValidation, makeFullISOStringFromMonthYear } from '../utils'\nimport { IconBlock } from '../components/icon-block/icon-block'\nimport style from '../calendar-input.css'\n\nconst defaultTheme = _.merge({}, Input.theme, style)\n\nconst RU_MONTH_REGEXP = /([\\d•]{4})-([\\d•]{2})/\n\nconst valueFormatting = (value) => {\n    if (Input.Masked.utils.isMaskedValue(value)) {\n        return value.replace(RU_MONTH_REGEXP, '$2.$1')\n    } else if ((value.length > MASK_MONTH.length) && isValid(value)) {\n        return format(toDate(value), MONTH_FORMAT, LOCALE)\n    }\n\n    return value\n}\n\nexport class MonthInput extends React.Component {\n    state = {\n        baseDate: this.props.value\n    }\n\n    // eslint-disable-next-line babel/camelcase, comment: React UNSAFE method\n    UNSAFE_componentWillReceiveProps (nextProps) {\n        if (this.props.value !== nextProps.value) {\n            if (dateStringValidation(nextProps.value)) {\n                this.setState({\n                    baseDate: nextProps.value\n                })\n            }\n        }\n    }\n    handleChange = (event) => {\n        if (Input.Masked.utils.isMaskedValue(this.props.value)) {\n            this.props.onChange(Input.getInputDiff(event.target.value, this.prevSelectionStart, event.target.selectionStart), event)\n        } else {\n            this.props.onChange(makeFullISOStringFromMonthYear(event.target.value, this.state.baseDate), event)\n        }\n    }\n    handleFocus = (event) => {\n        this.props.onFocus(makeFullISOStringFromMonthYear(event.target.value, this.state.baseDate), event)\n    }\n    handleBlur = (event) => {\n        this.props.onBlur(makeFullISOStringFromMonthYear(event.target.value, this.state.baseDate), event)\n    }\n    handleKeyDown = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onKeyDown(event)\n    }\n\n    handleContextMenu = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onContextMenu(event)\n    }\n\n    render () {\n        const { value, disabled, theme, ...passedProps } = this.props\n        const passingValue = valueFormatting(value)\n\n        const element = isTouchable() && isMobileEnabled() ? (\n            <Input\n                inputMode=\"decimal\"\n                {..._.omit(passedProps, ['forceOpened', 'restriction'])}\n                value={value}\n                placeholder={disabled ? EMPTY_STRING : MONTH_AND_YEAR_PLACEHOLDER}\n                autoComplete=\"off\"\n                onChange={this.handleChange}\n                onFocus={this.handleFocus}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDown}\n                onContextMenu={this.handleContextMenu}\n                disabled={disabled}\n                theme={theme}\n            />\n        ) : (\n            <Input.Masked.Typeahead\n                inputMode=\"decimal\"\n                {..._.omit(passedProps, ['forceOpened'])}\n                value={passingValue}\n                mask={Input.Masked.utils.maskedFormat(value.length === MASK_MONTH.length ? MASK_MONTH : MASK_MONTH_INVALID, value)}\n                guide={false}\n                placeholderChar=\"_\"\n                placeholder={disabled ? EMPTY_STRING : MONTH_AND_YEAR_PLACEHOLDER}\n                autoComplete=\"off\"\n                onChange={this.handleChange}\n                onFocus={this.handleFocus}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDown}\n                onContextMenu={this.handleContextMenu}\n                disabled={disabled}\n                theme={theme}\n            />\n        )\n\n        return (\n            <div className={theme.calendarMonthYearBlock}>\n                {element}\n                {!disabled && <IconBlock className={theme.iconPosition} />}\n            </div>\n        )\n    }\n}\n\nMonthInput.propTypes = {\n    value: PropTypes.string,\n    error: PropTypes.string,\n    onChange: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    onContextMenu: PropTypes.func,\n    name: PropTypes.string,\n    disabled: PropTypes.bool,\n    theme: PropTypes.shape({\n        input: PropTypes.string,\n        calendarMonthYearBlock: PropTypes.string,\n        iconPosition: PropTypes.string,\n        block: PropTypes.string,\n        disabled: PropTypes.string,\n        error: PropTypes.string,\n        icon: PropTypes.string,\n        inputIcon: PropTypes.string\n    })\n}\n\nMonthInput.defaultProps = {\n    value: '',\n    error: void 0,\n    onChange: _.noop,\n    onFocus: _.noop,\n    onBlur: _.noop,\n    onKeyDown: _.noop,\n    onContextMenu: _.noop,\n    name: EMPTY_STRING,\n    disabled: false,\n    theme: defaultTheme\n}\n\nMonthInput.theme = defaultTheme\n"],"names":["defaultTheme","_","merge","Input","theme","style","RU_MONTH_REGEXP","valueFormatting","value","Masked","utils","isMaskedValue","replace","length","MASK_MONTH","isValid","format","toDate","MONTH_FORMAT","LOCALE","MonthInput","baseDate","props","event","onChange","getInputDiff","target","prevSelectionStart","selectionStart","makeFullISOStringFromMonthYear","state","onFocus","onBlur","onKeyDown","onContextMenu","nextProps","dateStringValidation","setState","disabled","passedProps","passingValue","element","isTouchable","isMobileEnabled","omit","EMPTY_STRING","MONTH_AND_YEAR_PLACEHOLDER","handleChange","handleFocus","handleBlur","handleKeyDown","handleContextMenu","maskedFormat","MASK_MONTH_INVALID","calendarMonthYearBlock","iconPosition","React","Component","propTypes","PropTypes","string","error","func","name","bool","shape","input","block","icon","inputIcon","defaultProps","noop"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBA,IAAMA,YAAY,GAAGC,CAAC,CAACC,KAAF,CAAQ,EAAR,EAAYC,KAAK,CAACC,KAAlB,EAAyBC,KAAzB,CAArB;;AAEA,IAAMC,eAAe,GAAG,uBAAxB;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACC,KAAD,EAAW;AAC/B,MAAIL,KAAK,CAACM,MAAN,CAAaC,KAAb,CAAmBC,aAAnB,CAAiCH,KAAjC,CAAJ,EAA6C;AACzC,WAAOA,KAAK,CAACI,OAAN,CAAcN,eAAd,EAA+B,OAA/B,CAAP;AACH,GAFD,MAEO,IAAKE,KAAK,CAACK,MAAN,GAAeC,UAAU,CAACD,MAA3B,IAAsCE,OAAO,CAACP,KAAD,CAAjD,EAA0D;AAC7D,WAAOQ,MAAM,CAACC,MAAM,CAACT,KAAD,CAAP,EAAgBU,YAAhB,EAA8BC,MAA9B,CAAb;AACH;;AAED,SAAOX,KAAP;AACH,CARD;;IAUaY,UAAb;AAAA;;AAAA;;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;;AAAA;;AAAA,4DACY;AACJC,MAAAA,QAAQ,EAAE,MAAKC,KAAL,CAAWd;AADjB,KADZ;;AAAA,mEAemB,UAACe,KAAD,EAAW;AACtB,UAAIpB,KAAK,CAACM,MAAN,CAAaC,KAAb,CAAmBC,aAAnB,CAAiC,MAAKW,KAAL,CAAWd,KAA5C,CAAJ,EAAwD;AACpD,cAAKc,KAAL,CAAWE,QAAX,CAAoBrB,KAAK,CAACsB,YAAN,CAAmBF,KAAK,CAACG,MAAN,CAAalB,KAAhC,EAAuC,MAAKmB,kBAA5C,EAAgEJ,KAAK,CAACG,MAAN,CAAaE,cAA7E,CAApB,EAAkHL,KAAlH;AACH,OAFD,MAEO;AACH,cAAKD,KAAL,CAAWE,QAAX,CAAoBK,8BAA8B,CAACN,KAAK,CAACG,MAAN,CAAalB,KAAd,EAAqB,MAAKsB,KAAL,CAAWT,QAAhC,CAAlD,EAA6FE,KAA7F;AACH;AACJ,KArBL;;AAAA,kEAsBkB,UAACA,KAAD,EAAW;AACrB,YAAKD,KAAL,CAAWS,OAAX,CAAmBF,8BAA8B,CAACN,KAAK,CAACG,MAAN,CAAalB,KAAd,EAAqB,MAAKsB,KAAL,CAAWT,QAAhC,CAAjD,EAA4FE,KAA5F;AACH,KAxBL;;AAAA,iEAyBiB,UAACA,KAAD,EAAW;AACpB,YAAKD,KAAL,CAAWU,MAAX,CAAkBH,8BAA8B,CAACN,KAAK,CAACG,MAAN,CAAalB,KAAd,EAAqB,MAAKsB,KAAL,CAAWT,QAAhC,CAAhD,EAA2FE,KAA3F;AACH,KA3BL;;AAAA,oEA4BoB,UAACA,KAAD,EAAW;AACvB,YAAKI,kBAAL,GAA0BJ,KAAK,CAACG,MAAN,CAAaE,cAAvC;;AACA,YAAKN,KAAL,CAAWW,SAAX,CAAqBV,KAArB;AACH,KA/BL;;AAAA,wEAiCwB,UAACA,KAAD,EAAW;AAC3B,YAAKI,kBAAL,GAA0BJ,KAAK,CAACG,MAAN,CAAaE,cAAvC;;AACA,YAAKN,KAAL,CAAWY,aAAX,CAAyBX,KAAzB;AACH,KApCL;;AAAA;AAAA;;AAAA;AAAA;AAKI;AALJ,qDAMsCY,SANtC,EAMiD;AACzC,UAAI,KAAKb,KAAL,CAAWd,KAAX,KAAqB2B,SAAS,CAAC3B,KAAnC,EAA0C;AACtC,YAAI4B,oBAAoB,CAACD,SAAS,CAAC3B,KAAX,CAAxB,EAA2C;AACvC,eAAK6B,QAAL,CAAc;AACVhB,YAAAA,QAAQ,EAAEc,SAAS,CAAC3B;AADV,WAAd;AAGH;AACJ;AACJ;AAdL;AAAA;AAAA,6BAsCc;AAAA,wBAC6C,KAAKc,KADlD;AAAA,UACEd,KADF,eACEA,KADF;AAAA,UACS8B,QADT,eACSA,QADT;AAAA,UACmBlC,KADnB,eACmBA,KADnB;AAAA,UAC6BmC,WAD7B;;AAEN,UAAMC,YAAY,GAAGjC,eAAe,CAACC,KAAD,CAApC;AAEA,UAAMiC,OAAO,GAAGC,WAAW,MAAMC,eAAe,EAAhC,gBACZ,oBAAC,KAAD;AACI,QAAA,SAAS,EAAC;AADd,SAEQ1C,CAAC,CAAC2C,IAAF,CAAOL,WAAP,EAAoB,CAAC,aAAD,EAAgB,aAAhB,CAApB,CAFR;AAGI,QAAA,KAAK,EAAE/B,KAHX;AAII,QAAA,WAAW,EAAE8B,QAAQ,GAAGO,YAAH,GAAkBC,0BAJ3C;AAKI,QAAA,YAAY,EAAC,KALjB;AAMI,QAAA,QAAQ,EAAE,KAAKC,YANnB;AAOI,QAAA,OAAO,EAAE,KAAKC,WAPlB;AAQI,QAAA,MAAM,EAAE,KAAKC,UARjB;AASI,QAAA,SAAS,EAAE,KAAKC,aATpB;AAUI,QAAA,aAAa,EAAE,KAAKC,iBAVxB;AAWI,QAAA,QAAQ,EAAEb,QAXd;AAYI,QAAA,KAAK,EAAElC;AAZX,SADY,gBAgBZ,oBAAC,KAAD,CAAO,MAAP,CAAc,SAAd;AACI,QAAA,SAAS,EAAC;AADd,SAEQH,CAAC,CAAC2C,IAAF,CAAOL,WAAP,EAAoB,CAAC,aAAD,CAApB,CAFR;AAGI,QAAA,KAAK,EAAEC,YAHX;AAII,QAAA,IAAI,EAAErC,KAAK,CAACM,MAAN,CAAaC,KAAb,CAAmB0C,YAAnB,CAAgC5C,KAAK,CAACK,MAAN,KAAiBC,UAAU,CAACD,MAA5B,GAAqCC,UAArC,GAAkDuC,kBAAlF,EAAsG7C,KAAtG,CAJV;AAKI,QAAA,KAAK,EAAE,KALX;AAMI,QAAA,eAAe,EAAC,GANpB;AAOI,QAAA,WAAW,EAAE8B,QAAQ,GAAGO,YAAH,GAAkBC,0BAP3C;AAQI,QAAA,YAAY,EAAC,KARjB;AASI,QAAA,QAAQ,EAAE,KAAKC,YATnB;AAUI,QAAA,OAAO,EAAE,KAAKC,WAVlB;AAWI,QAAA,MAAM,EAAE,KAAKC,UAXjB;AAYI,QAAA,SAAS,EAAE,KAAKC,aAZpB;AAaI,QAAA,aAAa,EAAE,KAAKC,iBAbxB;AAcI,QAAA,QAAQ,EAAEb,QAdd;AAeI,QAAA,KAAK,EAAElC;AAfX,SAhBJ;AAmCA,0BACI;AAAK,QAAA,SAAS,EAAEA,KAAK,CAACkD;AAAtB,SACKb,OADL,EAEK,CAACH,QAAD,iBAAa,oBAAC,SAAD;AAAW,QAAA,SAAS,EAAElC,KAAK,CAACmD;AAA5B,QAFlB,CADJ;AAMH;AAnFL;;AAAA;AAAA,EAAgCC,KAAK,CAACC,SAAtC;AAsFArC,UAAU,CAACsC,SAAX,GAAuB;AACnBlD,EAAAA,KAAK,EAAEmD,SAAS,CAACC,MADE;AAEnBC,EAAAA,KAAK,EAAEF,SAAS,CAACC,MAFE;AAGnBpC,EAAAA,QAAQ,EAAEmC,SAAS,CAACG,IAHD;AAInB/B,EAAAA,OAAO,EAAE4B,SAAS,CAACG,IAJA;AAKnB9B,EAAAA,MAAM,EAAE2B,SAAS,CAACG,IALC;AAMnB7B,EAAAA,SAAS,EAAE0B,SAAS,CAACG,IANF;AAOnB5B,EAAAA,aAAa,EAAEyB,SAAS,CAACG,IAPN;AAQnBC,EAAAA,IAAI,EAAEJ,SAAS,CAACC,MARG;AASnBtB,EAAAA,QAAQ,EAAEqB,SAAS,CAACK,IATD;AAUnB5D,EAAAA,KAAK,EAAEuD,SAAS,CAACM,KAAV,CAAgB;AACnBC,IAAAA,KAAK,EAAEP,SAAS,CAACC,MADE;AAEnBN,IAAAA,sBAAsB,EAAEK,SAAS,CAACC,MAFf;AAGnBL,IAAAA,YAAY,EAAEI,SAAS,CAACC,MAHL;AAInBO,IAAAA,KAAK,EAAER,SAAS,CAACC,MAJE;AAKnBtB,IAAAA,QAAQ,EAAEqB,SAAS,CAACC,MALD;AAMnBC,IAAAA,KAAK,EAAEF,SAAS,CAACC,MANE;AAOnBQ,IAAAA,IAAI,EAAET,SAAS,CAACC,MAPG;AAQnBS,IAAAA,SAAS,EAAEV,SAAS,CAACC;AARF,GAAhB;AAVY,CAAvB;AAsBAxC,UAAU,CAACkD,YAAX,GAA0B;AACtB9D,EAAAA,KAAK,EAAE,EADe;AAEtBqD,EAAAA,KAAK,EAAE,KAAK,CAFU;AAGtBrC,EAAAA,QAAQ,EAAEvB,CAAC,CAACsE,IAHU;AAItBxC,EAAAA,OAAO,EAAE9B,CAAC,CAACsE,IAJW;AAKtBvC,EAAAA,MAAM,EAAE/B,CAAC,CAACsE,IALY;AAMtBtC,EAAAA,SAAS,EAAEhC,CAAC,CAACsE,IANS;AAOtBrC,EAAAA,aAAa,EAAEjC,CAAC,CAACsE,IAPK;AAQtBR,EAAAA,IAAI,EAAElB,YARgB;AAStBP,EAAAA,QAAQ,EAAE,KATY;AAUtBlC,EAAAA,KAAK,EAAEJ;AAVe,CAA1B;AAaAoB,UAAU,CAAChB,KAAX,GAAmBJ,YAAnB;;;;"}