{"version":3,"file":"year-input.js","sources":["../../../src/calendar/year-picker/year-input.jsx"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\nimport { format, isValid, toDate, setYear } from 'date-fns'\n\nimport { Input } from '../../input'\nimport {\n    LOCALE,\n    EMPTY_STRING,\n    MASK_YEAR,\n    YEAR_FORMAT,\n    underScoreWidthSpaceRegExp,\n    MASK_YEAR_INVALID\n} from '../constants'\nimport { dateStringValidation, fullISOFormat } from '../utils'\nimport { IconBlock } from '../components/icon-block/icon-block'\nimport style from '../calendar-input.css'\n\nconst defaultTheme = _.merge({}, Input.theme, style)\n\nconst makeFullISOString = (year, date) =>\n    (year.length < YEAR_FORMAT.length) || underScoreWidthSpaceRegExp.test(year)\n        ? year\n        : fullISOFormat(setYear(isValid(date) ? date : new Date(), year))\n\nconst valueFormatting = (value) => {\n    if (Input.Masked.utils.isMaskedValue(value)) {\n        return value\n    } else if ((value.length > MASK_YEAR.length) && isValid(value) && !underScoreWidthSpaceRegExp.test(value)) {\n        return format(toDate(value), YEAR_FORMAT, LOCALE)\n    }\n\n    return value\n}\n\nexport class YearInput extends React.PureComponent {\n    state = {\n        baseDate: this.props.value\n    }\n\n    // eslint-disable-next-line babel/camelcase, comment: React UNSAFE method\n    UNSAFE_componentWillReceiveProps (nextProps) {\n        if (this.props.value !== nextProps.value) {\n            if (dateStringValidation(nextProps.value)) {\n                this.setState({\n                    baseDate: nextProps.value\n                })\n            }\n        }\n    }\n    handleChange = (event) => {\n        if (Input.Masked.utils.isMaskedValue(this.props.value)) {\n            this.props.onChange(Input.getInputDiff(event.target.value, this.prevSelectionStart, event.target.selectionStart), event)\n        } else {\n            this.props.onChange(makeFullISOString(event.target.value, this.state.baseDate), event)\n        }\n    }\n    handleFocus = (event) => {\n        this.props.onFocus(makeFullISOString(event.target.value, this.state.baseDate), event)\n    }\n    handleBlur = (event) => {\n        this.props.onBlur(makeFullISOString(event.target.value, this.state.baseDate), event)\n    }\n    handleKeyDown = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onKeyDown(event)\n    }\n\n    handleContextMenu = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onContextMenu(event)\n    }\n\n    render () {\n        const { value, disabled, theme, ...passedProps } = this.props\n        const passingValue = valueFormatting(value)\n        return (\n            <div className={theme.calendarMonthYearBlock}>\n                <Input.Masked.Typeahead\n                    inputMode=\"decimal\"\n                    {...passedProps}\n                    value={passingValue}\n                    mask={Input.Masked.utils.maskedFormat(value.length === MASK_YEAR.length ? MASK_YEAR : MASK_YEAR_INVALID, value)}\n                    guide={false}\n                    placeholderChar=\"_\"\n                    placeholder={disabled ? EMPTY_STRING : '____'}\n                    autoComplete=\"off\"\n                    onChange={this.handleChange}\n                    onFocus={this.handleFocus}\n                    onBlur={this.handleBlur}\n                    onKeyDown={this.handleKeyDown}\n                    onContextMenu={this.handleContextMenu}\n                    disabled={disabled}\n                    theme={theme}\n                />\n                {!disabled && <IconBlock className={theme.iconPosition} />}\n            </div>\n        )\n    }\n}\n\nYearInput.propTypes = {\n    value: PropTypes.string,\n    error: PropTypes.string,\n    onChange: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    onContextMenu: PropTypes.func,\n    name: PropTypes.string,\n    disabled: PropTypes.bool,\n    theme: PropTypes.shape({\n        input: PropTypes.string,\n        calendarMonthYearBlock: PropTypes.string,\n        iconPosition: PropTypes.string,\n        block: PropTypes.string,\n        disabled: PropTypes.string,\n        error: PropTypes.string,\n        icon: PropTypes.string,\n        inputIcon: PropTypes.string\n    })\n}\n\nYearInput.defaultProps = {\n    value: '',\n    error: void 0,\n    onChange: _.noop,\n    onFocus: _.noop,\n    onBlur: _.noop,\n    onKeyDown: _.noop,\n    onContextMenu: _.noop,\n    name: EMPTY_STRING,\n    disabled: false,\n    theme: defaultTheme\n}\n\nYearInput.theme = defaultTheme\n"],"names":["defaultTheme","_","merge","Input","theme","style","makeFullISOString","year","date","length","YEAR_FORMAT","underScoreWidthSpaceRegExp","test","fullISOFormat","setYear","isValid","Date","valueFormatting","value","Masked","utils","isMaskedValue","MASK_YEAR","format","toDate","LOCALE","YearInput","baseDate","props","event","onChange","getInputDiff","target","prevSelectionStart","selectionStart","state","onFocus","onBlur","onKeyDown","onContextMenu","nextProps","dateStringValidation","setState","disabled","passedProps","passingValue","calendarMonthYearBlock","maskedFormat","MASK_YEAR_INVALID","EMPTY_STRING","handleChange","handleFocus","handleBlur","handleKeyDown","handleContextMenu","iconPosition","React","PureComponent","propTypes","PropTypes","string","error","func","name","bool","shape","input","block","icon","inputIcon","defaultProps","noop"],"mappings":"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"}