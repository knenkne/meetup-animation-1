{"version":3,"file":"time-input.js","sources":["../../../src/calendar/time-input/time-input.jsx"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\nimport { format, isValid, toDate } from 'date-fns'\n\nimport { Input } from '../../input'\nimport { mergeTheme, isTouchable } from '../../utils'\nimport {\n    LOCALE,\n    EMPTY_STRING,\n    TIME_MASK,\n    DATE_TIME_FORMAT,\n    TIME_PLACEHOLDER,\n    underScoreWidthSpaceRegExp\n} from '../constants'\nimport { dateStringValidation, makeFullISOFromTime } from '../utils'\nimport { isMobileEnabled } from '../mobile-enabler'\nimport { IconBlock } from '../components/icon-block/icon-block'\nimport style from '../calendar-input.css'\n\nconst defaultTheme = mergeTheme(Input.theme, style)\n\nconst valueFormatting = (value) => {\n    if (Input.Masked.utils.isMaskedValue(value)) {\n        return value\n    } else if ((value.length > TIME_MASK.length) && isValid(value) && !underScoreWidthSpaceRegExp.test(value)) {\n        return format(toDate(value), DATE_TIME_FORMAT, LOCALE)\n    }\n\n    return value\n}\n\n/* eslint-disable valid-jsdoc, comment: некорректный парсинг jsdoc */\n/**\n * [Zeplin](https://app.zeplin.io/project/59312e1ebdf1da6fc8d37ffb/dashboard?q=calendar)\n * Ввод времени\n *\n * @param {Object} props - свойства компонента\n * @return {JSX} - компонент\n */\nexport class TimeInput extends React.Component {\n    state = {\n        baseDate: this.props.value\n    }\n    // eslint-disable-next-line babel/camelcase, comment: React UNSAFE method\n    UNSAFE_componentWillReceiveProps (nextProps) {\n        if (this.props.value !== nextProps.value && dateStringValidation(nextProps.value)) {\n            this.setState({\n                baseDate: nextProps.value\n            })\n        }\n    }\n\n    handleChange = (event) => {\n        if (Input.Masked.utils.isMaskedValue(this.props.value)) {\n            this.props.onChange(Input.getInputDiff(event.target.value, this.prevSelectionStart, event.target.selectionStart), event)\n        } else {\n            this.props.onChange(makeFullISOFromTime(event.target.value, this.state.baseDate), event)\n        }\n    }\n    handleFocus = (event) => {\n        this.props.onFocus(makeFullISOFromTime(event.target.value, this.state.baseDate), event)\n    }\n    handleBlur = (event) => {\n        this.props.onBlur(makeFullISOFromTime(event.target.value, this.state.baseDate), event)\n    }\n    handleKeyDown = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onKeyDown(event)\n    }\n\n    handleContextMenu = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onContextMenu(event)\n    }\n\n    render () {\n        const { value, disabled, theme, ...passedProps } = this.props\n        const passingValue = valueFormatting(value)\n\n        const element = isTouchable() && isMobileEnabled() ? (\n            <Input\n                inputMode=\"decimal\"\n                {..._.omit(passedProps, 'restriction')}\n                value={passingValue}\n                placeholder={disabled ? EMPTY_STRING : TIME_PLACEHOLDER}\n                autoComplete=\"off\"\n                onChange={this.handleChange}\n                onFocus={this.handleFocus}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDown}\n                onContextMenu={this.handleContextMenu}\n                disabled={disabled}\n                theme={theme}\n                type=\"time\"\n            />\n        ) : (\n            <Input.Masked.Typeahead\n                inputMode=\"decimal\"\n                {...passedProps}\n                value={passingValue}\n                mask={Input.Masked.utils.maskedFormat(TIME_MASK, value)}\n                guide={false}\n                placeholderChar=\"_\"\n                placeholder={disabled ? EMPTY_STRING : TIME_PLACEHOLDER}\n                autoComplete=\"off\"\n                onChange={this.handleChange}\n                onFocus={this.handleFocus}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDown}\n                onContextMenu={this.handleContextMenu}\n                disabled={disabled}\n                theme={theme}\n            />\n        )\n\n        return (\n            <div className={theme.calendarTimeInputBlock}>\n                {element}\n                {!disabled && <IconBlock iconName=\"icon:core/common/time\" className={theme.iconPosition} />}\n            </div>\n        )\n    }\n}\n\nTimeInput.propTypes = {\n    value: PropTypes.string,\n    error: PropTypes.string,\n    onChange: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    onContextMenu: PropTypes.func,\n    name: PropTypes.string,\n    disabled: PropTypes.bool,\n    theme: PropTypes.shape({\n        input: PropTypes.string,\n        calendarTimeInputBlock: PropTypes.string,\n        iconPosition: PropTypes.string,\n        block: PropTypes.string,\n        disabled: PropTypes.string,\n        error: PropTypes.string,\n        icon: PropTypes.string,\n        inputIcon: PropTypes.string\n    })\n}\n\nTimeInput.defaultProps = {\n    value: '',\n    error: void 0,\n    onChange: _.noop,\n    onFocus: _.noop,\n    onBlur: _.noop,\n    onKeyDown: _.noop,\n    onContextMenu: _.noop,\n    name: '',\n    disabled: false,\n    theme: defaultTheme\n}\n\nTimeInput.theme = defaultTheme\nTimeInput.displayName = 'Calendar.Time.Input'\n"],"names":["defaultTheme","mergeTheme","Input","theme","style","valueFormatting","value","Masked","utils","isMaskedValue","length","TIME_MASK","isValid","underScoreWidthSpaceRegExp","test","format","toDate","DATE_TIME_FORMAT","LOCALE","TimeInput","baseDate","props","event","onChange","getInputDiff","target","prevSelectionStart","selectionStart","makeFullISOFromTime","state","onFocus","onBlur","onKeyDown","onContextMenu","nextProps","dateStringValidation","setState","disabled","passedProps","passingValue","element","isTouchable","isMobileEnabled","_","omit","EMPTY_STRING","TIME_PLACEHOLDER","handleChange","handleFocus","handleBlur","handleKeyDown","handleContextMenu","maskedFormat","calendarTimeInputBlock","iconPosition","React","Component","propTypes","PropTypes","string","error","func","name","bool","shape","input","block","icon","inputIcon","defaultProps","noop","displayName"],"mappings":"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"}