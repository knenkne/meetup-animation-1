{"version":3,"file":"tabs.js","sources":["../../src/tabs/tabs.jsx"],"sourcesContent":["import React, { useState, useMemo, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\n\nimport { Tab } from './tab'\nimport { Header } from './header'\nimport defaultTheme from './style.css'\nimport { getFirstChildTitle, useUpdateEffect } from './tab-utils'\n\nconst KEYS = {\n    35: 'end',\n    36: 'home',\n    37: 'left',\n    39: 'right'\n}\n\nconst DIRECTIONS = {\n    37: -1,\n    39: 1\n}\n\n/**\n * [Zeplin](https://app.zeplin.io/project/5c74ef0d753f3ebccdf8f33d/screen/5cab79d394299816a9a8595d)\n * Компонент параллельного отображения блоков верстки\n *\n * @param {Object} props - свойства компонента\n * @return {JSX} - компонент\n */\nexport const Tabs = ({\n    children,\n    initialValue,\n    onChange,\n    mode,\n    colorScheme,\n    size,\n    selectedItem,\n    onSelect,\n    theme\n}) => {\n    const parentId = useMemo(() => _.uniqueId('tab-wrapper-'), [])\n    const tabsId = useMemo(() => _.uniqueId('tabs-'), [])\n    const childrenArray = useMemo(() => React.Children.toArray(children))\n\n    const refs = useMemo(() => childrenArray.reduce((acc, child) => ({\n        ...acc,\n        [child.props?.title]: React.createRef()\n    }), {}), [children])\n\n    const { current: isControlled } = React.useRef(Boolean(selectedItem))\n    const [selectedTitle, setSelectedTitle] = useState(\n        isControlled\n            ? selectedItem\n            : initialValue || getFirstChildTitle(children)\n    )\n    const selectedTabTitle = isControlled ? selectedItem : selectedTitle\n\n    const selectedTabChild = useMemo(() => {\n        const properChild = childrenArray.find((child) => child.props?.title === selectedTabTitle)\n\n        return properChild?.props.children\n    })\n\n    const handleChange = useCallback(\n        (value) => isControlled ? onSelect(value) : setSelectedTitle(value),\n        [selectedTitle, selectedItem]\n    )\n\n    const focusTab = (title) => {\n        refs[title].current.focus()\n        handleChange(title)\n    }\n\n    // Either focus the next, previous, first, or last tab depening on key pressed\n    const handleKeyDown = (event) => {\n        const pressed = KEYS[event.keyCode]\n        const direction = DIRECTIONS[event.keyCode]\n\n        if (pressed) {\n            event.preventDefault()\n\n            if (pressed === 'end') {\n                focusTab(_.last(Object.keys(refs)))\n                return\n            }\n\n            if (pressed === 'home') {\n                focusTab(_.first(Object.keys(refs)))\n                return\n            }\n\n            const currentTabIndex = childrenArray.findIndex((child) => child.props?.title === selectedTabTitle)\n            const nextTitle = childrenArray[currentTabIndex + direction]?.props?.title\n\n            if (nextTitle) {\n                focusTab(nextTitle)\n            } else if (pressed === 'left') {\n                focusTab(_.last(Object.keys(refs)))\n            } else {\n                focusTab(_.first(Object.keys(refs)))\n            }\n        }\n    }\n\n    useUpdateEffect(() => {\n        onChange(selectedTitle)\n    }, [selectedTitle, selectedItem])\n\n    const mapChildren = () =>\n        childrenArray.map((child) => React.cloneElement(child, {\n            colorScheme,\n            forceOpened: child.props?.title === selectedTabTitle,\n            id: tabsId,\n            onChange: handleChange,\n            onKeyDown: handleKeyDown,\n            parentId,\n            size,\n            ref: refs[child.props.title]\n        }))\n\n    return (\n        <div data-unit=\"tabs\" aria-live=\"polite\" className={theme.tabs}>\n            <Header parentId={parentId} mode={mode} theme={theme}>\n                <div data-unit=\"tabs:navigation\" role=\"tablist\">\n                    {mapChildren()}\n                </div>\n            </Header>\n            {!!selectedTabChild && <section\n                id={`panel-${tabsId}`}\n                role=\"tabpanel\"\n                className={theme.tabsContent}\n                aria-labelledby={`tab-${tabsId}`}\n                key={selectedTitle}\n                tabIndex=\"0\"\n            >\n                {selectedTabChild}\n            </section>}\n        </div>\n    )\n}\n\nTabs.propTypes = {\n    onChange: PropTypes.func,\n    selectedItem: PropTypes.string,\n    onSelect: PropTypes.func,\n    /**\n     * Общая цветовая схема\n     */\n    colorScheme: PropTypes.oneOf([\n        'base',\n        'purple',\n        'blue',\n        'green',\n        'black',\n        'skyblue',\n        'aqua',\n        'gold'\n    ]),\n    initialValue: PropTypes.string,\n    children: PropTypes.node,\n    size: PropTypes.oneOf(['sm', 'lg']),\n    /**\n     * Если нужны табы с длинной линией по всей ширине контентой части для продуктовой страницы\n     */\n    mode: PropTypes.oneOfType([\n        PropTypes.oneOf(['sticky', 'fullwidth', 'borderless']),\n        PropTypes.arrayOf(PropTypes.oneOf(['sticky', 'fullwidth']))\n    ]),\n    theme: PropTypes.object\n}\n\nTabs.defaultProps = {\n    onChange: _.noop,\n    selectedItem: void 0,\n    onSelect: _.noop,\n    colorScheme: 'base',\n    initialValue: void 0,\n    children: void 0,\n    size: 'lg',\n    mode: void 0,\n    theme: defaultTheme\n}\n\nTabs.theme = defaultTheme\nTabs.Tab = Tab\nTabs.displayName = 'Tabs'\n"],"names":["KEYS","DIRECTIONS","Tabs","children","initialValue","onChange","mode","colorScheme","size","selectedItem","onSelect","theme","parentId","useMemo","_","uniqueId","tabsId","childrenArray","React","Children","toArray","refs","reduce","acc","child","props","title","createRef","useRef","Boolean","isControlled","current","useState","getFirstChildTitle","selectedTitle","setSelectedTitle","selectedTabTitle","selectedTabChild","properChild","find","handleChange","useCallback","value","focusTab","focus","handleKeyDown","event","pressed","keyCode","direction","preventDefault","last","Object","keys","first","currentTabIndex","findIndex","nextTitle","useUpdateEffect","mapChildren","map","cloneElement","forceOpened","id","onKeyDown","ref","tabs","tabsContent","propTypes","PropTypes","func","string","oneOf","node","oneOfType","arrayOf","object","defaultProps","noop","defaultTheme","Tab","displayName"],"mappings":"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"}