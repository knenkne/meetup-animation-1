{"version":3,"file":"custom-tag.js","sources":["../../../src/markdown/custom-rules/custom-tag.js"],"sourcesContent":["import _ from 'lodash'\nimport { escapeHtml } from 'remarkable/lib/common/utils'\n\n/**\n * @param {Object} md - markdown instance\n * @param {Object} options\n * @param {String} options.templateName\n * @param {String} options.tag\n * @param {Function} options.render\n *\n * Подключение к инстансу Remarkable\n * равному md:\n * md.use(customTag, {\n *   templateName: 'wow',\n *   tag: 'wow',\n *   render: (content) => `<span style=\"color: blue\">${content}</span>`\n *  })\n *\n * Пример использования:\n * <wow>Wow!</wow> => <span style=\"color: blue\">Wow!</span>\n */\n\nexport const customTag = (md, { templateName, tag, render }) => {\n    Object.assign(md.renderer.rules, {\n        [templateName]: (tokens, idx) =>\n            render(`${escapeHtml(tokens[idx].content)}`)\n    })\n    md.core.ruler.push(templateName, ({ tokens }) =>\n        tokens.forEach((token) =>\n            _.each(token.children, (child) => {\n                if (child.type !== 'text') {\n                    return\n                }\n\n                const exp = new RegExp(`<${tag}>(.*)</${tag}>`, 'i')\n                const contentMatch = child.content.match(exp)\n\n                if (contentMatch) {\n                    Object.assign(child, {\n                        type: templateName,\n                        content: contentMatch[1]\n                    })\n                }\n            })\n        )\n    )\n}\n"],"names":["customTag","md","templateName","tag","render","Object","assign","renderer","rules","tokens","idx","escapeHtml","content","core","ruler","push","forEach","token","_","each","children","child","type","exp","RegExp","contentMatch","match"],"mappings":";;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEaA,SAAS,GAAG,SAAZA,SAAY,CAACC,EAAD,QAAuC;AAAA,MAAhCC,YAAgC,QAAhCA,YAAgC;AAAA,MAAlBC,GAAkB,QAAlBA,GAAkB;AAAA,MAAbC,MAAa,QAAbA,MAAa;AAC5DC,EAAAA,MAAM,CAACC,MAAP,CAAcL,EAAE,CAACM,QAAH,CAAYC,KAA1B,sBACKN,YADL,EACoB,UAACO,MAAD,EAASC,GAAT;AAAA,WACZN,MAAM,WAAIO,UAAU,CAACF,MAAM,CAACC,GAAD,CAAN,CAAYE,OAAb,CAAd,EADM;AAAA,GADpB;AAIAX,EAAAA,EAAE,CAACY,IAAH,CAAQC,KAAR,CAAcC,IAAd,CAAmBb,YAAnB,EAAiC;AAAA,QAAGO,MAAH,SAAGA,MAAH;AAAA,WAC7BA,MAAM,CAACO,OAAP,CAAe,UAACC,KAAD;AAAA,aACXC,CAAC,CAACC,IAAF,CAAOF,KAAK,CAACG,QAAb,EAAuB,UAACC,KAAD,EAAW;AAC9B,YAAIA,KAAK,CAACC,IAAN,KAAe,MAAnB,EAA2B;AACvB;AACH;;AAED,YAAMC,GAAG,GAAG,IAAIC,MAAJ,YAAerB,GAAf,oBAA4BA,GAA5B,QAAoC,GAApC,CAAZ;AACA,YAAMsB,YAAY,GAAGJ,KAAK,CAACT,OAAN,CAAcc,KAAd,CAAoBH,GAApB,CAArB;;AAEA,YAAIE,YAAJ,EAAkB;AACdpB,UAAAA,MAAM,CAACC,MAAP,CAAce,KAAd,EAAqB;AACjBC,YAAAA,IAAI,EAAEpB,YADW;AAEjBU,YAAAA,OAAO,EAAEa,YAAY,CAAC,CAAD;AAFJ,WAArB;AAIH;AACJ,OAdD,CADW;AAAA,KAAf,CAD6B;AAAA,GAAjC;AAmBH;;;;"}