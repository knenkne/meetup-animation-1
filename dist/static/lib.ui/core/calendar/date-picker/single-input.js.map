{"version":3,"file":"single-input.js","sources":["../../../src/calendar/date-picker/single-input.jsx"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\nimport { format, isValid, toDate } from 'date-fns'\n\nimport { Input } from '../../input'\nimport { isTouchable } from '../../utils'\nimport { isMobileEnabled } from '../mobile-enabler'\nimport {\n    LOCALE,\n    EMPTY_STRING,\n    MASK_DATE,\n    MASK_DATE_INVALID,\n    PLACEHOLDER,\n    RU_DATE_REGEXP,\n    underScoreWidthSpaceRegExp\n} from '../constants'\nimport { isofyingDateString } from '../utils'\nimport style from '../calendar-input.css'\n\nconst defaultTheme = { ...Input.theme, ...style }\nconst prepareValue = (value) => {\n    if (Input.Masked.utils.isMaskedValue(value)) {\n        return value.replace(RU_DATE_REGEXP, '$3.$2.$1')\n    } else if ((value.length > MASK_DATE.length) && isValid(value) && !underScoreWidthSpaceRegExp.test(value)) {\n        return format(toDate(value), 'L', LOCALE)\n    }\n\n    return value\n}\n\nexport class SingleInput extends React.PureComponent {\n\n    handleChange = (event) => {\n        if (Input.Masked.utils.isMaskedValue(this.props.value)) {\n            this.props.onChange(Input.getInputDiff(event.target.value, this.prevSelectionStart, event.target.selectionStart), event)\n        } else {\n            this.props.onChange(isofyingDateString({ value: event.target.value }), event)\n        }\n    }\n    handleFocus = (event) => {\n        this.props.onFocus(isofyingDateString({ value: event.target.value }), event)\n    }\n    handleBlur = (event) => {\n        this.props.onBlur(isofyingDateString({ value: event.target.value }), event)\n    }\n    handleKeyDown = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onKeyDown(event)\n    }\n    handleContextMenu = (event) => {\n        this.prevSelectionStart = event.target.selectionStart\n        this.props.onContextMenu(event)\n    }\n\n    render () {\n        const { value, disabled, theme, icon, ...passedProps } = this.props\n        const inputElement = isTouchable() && isMobileEnabled() ? (\n            <Input\n                inputMode=\"decimal\"\n                {..._.omit(passedProps, 'restriction')}\n                value={value.split('T')[0]}\n                placeholder={disabled ? EMPTY_STRING : PLACEHOLDER}\n                autoComplete=\"off\"\n                onChange={this.handleChange}\n                onFocus={this.handleFocus}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDown}\n                onContextMenu={this.handleContextMenu}\n                disabled={disabled}\n                theme={theme}\n                icon={icon}\n            />\n        ) : (\n            <Input.Masked.Typeahead\n                inputMode=\"decimal\"\n                {...passedProps}\n                value={prepareValue(value)}\n                mask={Input.Masked.utils.maskedFormat(value.length === MASK_DATE.length ? MASK_DATE : MASK_DATE_INVALID, value)}\n                guide={false}\n                placeholderChar=\"_\"\n                placeholder={disabled ? EMPTY_STRING : PLACEHOLDER}\n                autoComplete=\"off\"\n                onChange={this.handleChange}\n                onFocus={this.handleFocus}\n                onBlur={this.handleBlur}\n                onKeyDown={this.handleKeyDown}\n                onContextMenu={this.handleContextMenu}\n                disabled={disabled}\n                theme={theme}\n                icon={icon}\n            />\n        )\n\n        return inputElement\n    }\n}\n\nSingleInput.propTypes = {\n    value: PropTypes.string,\n    error: PropTypes.string,\n    onChange: PropTypes.func,\n    onFocus: PropTypes.func,\n    onBlur: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    onContextMenu: PropTypes.func,\n    name: PropTypes.string,\n    disabled: PropTypes.bool,\n    theme: PropTypes.shape({\n        input: PropTypes.string,\n        calendarInputBlock: PropTypes.string,\n        iconPosition: PropTypes.string,\n        block: PropTypes.string,\n        disabled: PropTypes.string,\n        error: PropTypes.string,\n        icon: PropTypes.string,\n        inputIcon: PropTypes.string\n    }),\n    icon: PropTypes.string\n}\n\nSingleInput.defaultProps = {\n    value: '',\n    error: void 0,\n    onChange: _.noop,\n    onFocus: _.noop,\n    onBlur: _.noop,\n    onKeyDown: _.noop,\n    onContextMenu: _.noop,\n    name: EMPTY_STRING,\n    disabled: false,\n    theme: defaultTheme,\n    icon: 'icon:core/common/calendar'\n}\n\nSingleInput.theme = defaultTheme\n"],"names":["defaultTheme","Input","theme","style","prepareValue","value","Masked","utils","isMaskedValue","replace","RU_DATE_REGEXP","length","MASK_DATE","isValid","underScoreWidthSpaceRegExp","test","format","toDate","LOCALE","SingleInput","event","props","onChange","getInputDiff","target","prevSelectionStart","selectionStart","isofyingDateString","onFocus","onBlur","onKeyDown","onContextMenu","disabled","icon","passedProps","inputElement","isTouchable","isMobileEnabled","_","omit","split","EMPTY_STRING","PLACEHOLDER","handleChange","handleFocus","handleBlur","handleKeyDown","handleContextMenu","maskedFormat","MASK_DATE_INVALID","React","PureComponent","propTypes","PropTypes","string","error","func","name","bool","shape","input","calendarInputBlock","iconPosition","block","inputIcon","defaultProps","noop"],"mappings":"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"}