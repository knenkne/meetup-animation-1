{"version":3,"file":"menu.js","sources":["../../src/menu/menu.jsx"],"sourcesContent":["import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport _ from 'lodash'\nimport cs from 'classnames'\n\nimport { Perimeter } from '../perimeter'\nimport { Link } from '../link'\nimport { cyclicPrevItem, cyclicNextItem, keyCodes } from '../listbox/utils'\nimport { isTouchable } from '../utils/adaptive'\nimport { Icon } from '../icon'\nimport { Typography } from '../typography'\n\nimport defaultTheme from './style.css'\n\nconst TYPING_SYMBOLS = /[A-Za-zЁА-яё]/\n\nexport class Menu extends Component {\n    static propTypes = {\n        id: PropTypes.string,\n        options: PropTypes.arrayOf(PropTypes.shape({\n            value: PropTypes.string,\n            title: PropTypes.string,\n            action: PropTypes.func,\n            type: PropTypes.oneOf(['link', 'linkout', 'option']),\n            as: PropTypes.func,\n            onClick: PropTypes.func\n        })),\n        title: PropTypes.string,\n        icon: PropTypes.string,\n        onOpen: PropTypes.func,\n        onClose: PropTypes.func,\n        mode: PropTypes.oneOf(['hover', 'click']),\n        theme: PropTypes.object,\n        a11y: PropTypes.shape({\n            /**\n             * заголовок кнопки меню\n             */\n            title: PropTypes.string\n        })\n    }\n\n    static defaultProps = {\n        id: void 0,\n        options: [],\n        icon: 'threeDots',\n        title: void 0,\n        onOpen: _.noop,\n        onClose: _.noop,\n        mode: 'hover',\n        theme: defaultTheme,\n        a11y: {\n            title: \"Меню\"\n        }\n    }\n\n    constructor (props) {\n        super(props)\n\n        this.state = {\n            expanded: false,\n            activeDescendant: this.getOptionValue()\n        }\n\n        this.id = this.props.id || _.uniqueId('ui-menu')\n        this.linkTheme = { link: this.props.theme.optionContent }\n    }\n\n    setRefTarget = (c) => {\n        this.target = c\n    }\n\n    setRefContents = (c) => {\n        this.contents = c\n    }\n\n    getOptionValue = (index = 0) => this.props.options[index].value\n\n    handleTargetClick = (event) => {\n        if (this.state.expanded) {\n            this.handleClose(event)\n        } else {\n            this.handleOpen(event)\n        }\n    }\n\n    handleTargetMouse = (event) => {\n        if (!isTouchable()) {\n            this.handleOpen(event)\n        }\n    }\n\n    handleMouseLeave = (event) => {\n        this.handleClose(event)\n    }\n\n    handleOpen = (event) => {\n        if (event.persist) {\n            event.persist()\n        }\n\n        this.setState({\n            expanded: true\n        }, () => {\n            this.contents.focus()\n            this.props.onOpen(event)\n        })\n    }\n\n    handleClose = (event) => {\n        if (this.state.expanded) {\n            if (event.persist) {\n                event.persist()\n            }\n            this.setState({\n                expanded: false\n            }, () => {\n                this.target.focus()\n                this.props.onClose(event)\n            })\n        }\n    }\n\n    handleOptionFocus = (option) => this.setState({ activeDescendant: option.value })\n\n    handleOptionChoose = (option, event) => {\n        if (option.type === 'option') {\n            option.action(event)\n        }\n        this.handleClose(event)\n    }\n\n    // нужно только в меню\n    handleKeyDownTarget = (event) => {\n        switch (event.keyCode) {\n            case keyCodes.KEY_ENTER:\n            case keyCodes.KEY_SPACE:\n            case keyCodes.KEY_ARROW_DOWN: {\n                event.preventDefault()\n                this.handleOpen(event)\n                this.handleOptionFocus(this.props.options[0])\n                break\n            }\n            case keyCodes.KEY_ARROW_UP: {\n                event.preventDefault()\n                this.handleOpen(event)\n                this.handleOptionFocus(this.props.options[this.props.options.length - 1])\n                break\n            }\n\n            default: {\n                break\n            }\n        }\n    }\n\n    handleKeyDownContents = (event) => {\n        switch (event.keyCode) {\n            case keyCodes.KEY_TAB: {\n                this.handleClose(event)\n                break\n            }\n            case keyCodes.KEY_ENTER:\n            case keyCodes.KEY_SPACE: {\n                event.preventDefault()\n                this.handleOptionChoose(_.find(this.props.options, { value: this.state.activeDescendant }), event)\n                this.handleClose(event)\n                break\n            }\n            case keyCodes.KEY_ESCAPE: {\n                event.preventDefault()\n                this.handleClose(event)\n                break\n            }\n            case keyCodes.KEY_ARROW_DOWN: {\n                event.preventDefault()\n                this.handleOptionFocus(cyclicNextItem(this.props.options, this.state.activeDescendant))\n                break\n            }\n            case keyCodes.KEY_ARROW_UP: {\n                event.preventDefault()\n                this.handleOptionFocus(cyclicPrevItem(this.props.options, this.state.activeDescendant))\n                break\n            }\n            case keyCodes.KEY_HOME: {\n                event.preventDefault()\n                this.handleOptionFocus(this.props.options[0])\n                break\n            }\n            case keyCodes.KEY_END: {\n                event.preventDefault()\n                this.handleOptionFocus(this.props.options[this.props.options.length - 1])\n                break\n            }\n\n            default: {\n                break\n            }\n        }\n    }\n\n    handleKeyPressContents = (event) => {\n        const char = String.fromCharCode(event.charCode)\n\n        if (TYPING_SYMBOLS.test(char)) {\n            event.preventDefault()\n            const option = _.find(this.props.options, (o) => _.startsWith(o.title.toLowerCase(), char.toLowerCase()))\n\n            // двигать дальше, если фокусированный уже был выбран через алфавит\n            if (option) {\n                this.handleOptionFocus(option)\n            }\n        }\n    }\n\n    isActiveDescendant = (option) => this.state.activeDescendant === option.value\n\n    render () {\n        const { theme, title, mode } = this.props\n        const handlers = mode === 'hover'\n            ? { onMouseLeave: this.handleMouseLeave }\n            : {}\n\n        return (\n            <Perimeter onClickOutside={this.handleClose}>\n                <div\n                    id={this.id}\n                    className={cs(\n                        theme.menu,\n                        this.state.expanded && theme.expanded,\n                        !title && mode === 'click' && theme.iconMenu\n                    )}\n                    {...handlers}\n                >\n                    {this.renderTarget()}\n                    {this.renderContents()}\n                </div>\n            </Perimeter>\n        )\n    }\n\n    renderTarget = () => {\n        const { theme, title, mode, icon, a11y } = this.props\n        const handlers = mode === 'hover'\n            ? { onMouseEnter: this.handleTargetMouse }\n            : {}\n\n        return (\n            <button\n                type=\"button\"\n                id={`${this.id}-target`}\n                ref={this.setRefTarget}\n                onClick={this.handleTargetClick}\n                {...handlers}\n                className={theme.buttonControl}\n                // накрученное клавиатурное управление\n                onKeyDown={this.handleKeyDownTarget}\n                title={a11y.title}\n                aria-haspopup=\"true\"\n                aria-expanded={this.state.expanded ? true : void 0}\n                // указатель на содержимое\n                aria-controls={`${this.id}-contents`}\n            >\n                {title && <span className={cs(Typography.theme.body, theme.title)}>{title}</span>}\n                {icon && <Icon name={`icon:core/common/${icon}`} size=\"self\" />}\n            </button>\n        )\n    }\n\n    renderContents = () => (\n        <ul\n            id={`${this.id}-contents`}\n            className={this.props.theme.popup}\n            ref={this.setRefContents}\n            onKeyDown={this.handleKeyDownContents}\n            // специальное поведение для быстрого поиска операции\n            onKeyPress={this.handleKeyPressContents}\n            tabIndex={-1}\n            role=\"menu\"\n            aria-activedescendant={this.state.expanded ? `${this.id}-option-${this.state.activeDescendant}` : void 0}\n            // легко может ссылаться на самого себя\n            aria-labelledby={`${this.id}-target`}\n        >\n            {_.map(this.props.options, this.renderOption)}\n        </ul>\n    )\n\n    renderOption = (option) => {\n        const activeDescendant = this.isActiveDescendant(option)\n        const { type, title, value, as, action } = option\n        const handleClick = action || _.noop\n        let content = void 0\n\n        if (type === 'option') {\n            content = (\n                <button\n                    type=\"button\"\n                    className={this.props.theme.optionContent}\n                    tabIndex={-1}\n                    onClick={handleClick}\n                    onMouseUp={this.handleClose}\n                    role=\"menuitem\"\n                >\n                    {title}\n                </button>\n            )\n        } else if (type === 'link' || type === 'linkout') {\n            content = (\n                <Link\n                    theme={this.linkTheme}\n                    external={type === 'linkout'}\n                    href={value}\n                    as={as}\n                    tabIndex={-1}\n                    onMouseUp={this.handleClose}\n                    onClick={handleClick}\n                    role=\"menuitem\"\n                >\n                    {title}\n                </Link>\n            )\n        }\n\n        return (\n            <li\n                key={value}\n                id={`${this.id}-option-${value}`}\n                className={cs(\n                    this.props.theme.option,\n                    activeDescendant && this.props.theme.focused\n                )}\n                role=\"none\"\n            >\n                {content}\n            </li>\n        )\n    }\n}\n\nMenu.theme = defaultTheme\n\nexport default Menu\n"],"names":["TYPING_SYMBOLS","Menu","props","c","target","contents","index","options","value","event","state","expanded","handleClose","handleOpen","isTouchable","persist","setState","focus","onOpen","onClose","option","activeDescendant","type","action","keyCode","keyCodes","KEY_ENTER","KEY_SPACE","KEY_ARROW_DOWN","preventDefault","handleOptionFocus","KEY_ARROW_UP","length","KEY_TAB","handleOptionChoose","_","find","KEY_ESCAPE","cyclicNextItem","cyclicPrevItem","KEY_HOME","KEY_END","char","String","fromCharCode","charCode","test","o","startsWith","title","toLowerCase","theme","mode","icon","a11y","handlers","onMouseEnter","handleTargetMouse","id","setRefTarget","handleTargetClick","buttonControl","handleKeyDownTarget","cs","Typography","body","popup","setRefContents","handleKeyDownContents","handleKeyPressContents","map","renderOption","isActiveDescendant","as","handleClick","noop","content","optionContent","linkTheme","focused","getOptionValue","uniqueId","link","onMouseLeave","handleMouseLeave","menu","iconMenu","renderTarget","renderContents","Component","PropTypes","string","arrayOf","shape","func","oneOf","onClick","object","defaultTheme"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAcA,IAAMA,cAAc,GAAG,eAAvB;IAEaC,IAAb;AAAA;;AAAA;;AAuCI,gBAAaC,KAAb,EAAoB;AAAA;;AAAA;;AAChB,8BAAMA,KAAN;;AADgB,mEAYL,UAACC,CAAD,EAAO;AAClB,YAAKC,MAAL,GAAcD,CAAd;AACH,KAdmB;;AAAA,qEAgBH,UAACA,CAAD,EAAO;AACpB,YAAKE,QAAL,GAAgBF,CAAhB;AACH,KAlBmB;;AAAA,qEAoBH;AAAA,UAACG,KAAD,uEAAS,CAAT;AAAA,aAAe,MAAKJ,KAAL,CAAWK,OAAX,CAAmBD,KAAnB,EAA0BE,KAAzC;AAAA,KApBG;;AAAA,wEAsBA,UAACC,KAAD,EAAW;AAC3B,UAAI,MAAKC,KAAL,CAAWC,QAAf,EAAyB;AACrB,cAAKC,WAAL,CAAiBH,KAAjB;AACH,OAFD,MAEO;AACH,cAAKI,UAAL,CAAgBJ,KAAhB;AACH;AACJ,KA5BmB;;AAAA,wEA8BA,UAACA,KAAD,EAAW;AAC3B,UAAI,CAACK,WAAW,EAAhB,EAAoB;AAChB,cAAKD,UAAL,CAAgBJ,KAAhB;AACH;AACJ,KAlCmB;;AAAA,uEAoCD,UAACA,KAAD,EAAW;AAC1B,YAAKG,WAAL,CAAiBH,KAAjB;AACH,KAtCmB;;AAAA,iEAwCP,UAACA,KAAD,EAAW;AACpB,UAAIA,KAAK,CAACM,OAAV,EAAmB;AACfN,QAAAA,KAAK,CAACM,OAAN;AACH;;AAED,YAAKC,QAAL,CAAc;AACVL,QAAAA,QAAQ,EAAE;AADA,OAAd,EAEG,YAAM;AACL,cAAKN,QAAL,CAAcY,KAAd;;AACA,cAAKf,KAAL,CAAWgB,MAAX,CAAkBT,KAAlB;AACH,OALD;AAMH,KAnDmB;;AAAA,kEAqDN,UAACA,KAAD,EAAW;AACrB,UAAI,MAAKC,KAAL,CAAWC,QAAf,EAAyB;AACrB,YAAIF,KAAK,CAACM,OAAV,EAAmB;AACfN,UAAAA,KAAK,CAACM,OAAN;AACH;;AACD,cAAKC,QAAL,CAAc;AACVL,UAAAA,QAAQ,EAAE;AADA,SAAd,EAEG,YAAM;AACL,gBAAKP,MAAL,CAAYa,KAAZ;;AACA,gBAAKf,KAAL,CAAWiB,OAAX,CAAmBV,KAAnB;AACH,SALD;AAMH;AACJ,KAjEmB;;AAAA,wEAmEA,UAACW,MAAD;AAAA,aAAY,MAAKJ,QAAL,CAAc;AAAEK,QAAAA,gBAAgB,EAAED,MAAM,CAACZ;AAA3B,OAAd,CAAZ;AAAA,KAnEA;;AAAA,yEAqEC,UAACY,MAAD,EAASX,KAAT,EAAmB;AACpC,UAAIW,MAAM,CAACE,IAAP,KAAgB,QAApB,EAA8B;AAC1BF,QAAAA,MAAM,CAACG,MAAP,CAAcd,KAAd;AACH;;AACD,YAAKG,WAAL,CAAiBH,KAAjB;AACH,KA1EmB;;AAAA,0EA6EE,UAACA,KAAD,EAAW;AAC7B,cAAQA,KAAK,CAACe,OAAd;AACI,aAAKC,QAAQ,CAACC,SAAd;AACA,aAAKD,QAAQ,CAACE,SAAd;AACA,aAAKF,QAAQ,CAACG,cAAd;AAA8B;AAC1BnB,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKhB,UAAL,CAAgBJ,KAAhB;;AACA,kBAAKqB,iBAAL,CAAuB,MAAK5B,KAAL,CAAWK,OAAX,CAAmB,CAAnB,CAAvB;;AACA;AACH;;AACD,aAAKkB,QAAQ,CAACM,YAAd;AAA4B;AACxBtB,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKhB,UAAL,CAAgBJ,KAAhB;;AACA,kBAAKqB,iBAAL,CAAuB,MAAK5B,KAAL,CAAWK,OAAX,CAAmB,MAAKL,KAAL,CAAWK,OAAX,CAAmByB,MAAnB,GAA4B,CAA/C,CAAvB;;AACA;AACH;AAdL;AAoBH,KAlGmB;;AAAA,4EAoGI,UAACvB,KAAD,EAAW;AAC/B,cAAQA,KAAK,CAACe,OAAd;AACI,aAAKC,QAAQ,CAACQ,OAAd;AAAuB;AACnB,kBAAKrB,WAAL,CAAiBH,KAAjB;;AACA;AACH;;AACD,aAAKgB,QAAQ,CAACC,SAAd;AACA,aAAKD,QAAQ,CAACE,SAAd;AAAyB;AACrBlB,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKK,kBAAL,CAAwBC,CAAC,CAACC,IAAF,CAAO,MAAKlC,KAAL,CAAWK,OAAlB,EAA2B;AAAEC,cAAAA,KAAK,EAAE,MAAKE,KAAL,CAAWW;AAApB,aAA3B,CAAxB,EAA4FZ,KAA5F;;AACA,kBAAKG,WAAL,CAAiBH,KAAjB;;AACA;AACH;;AACD,aAAKgB,QAAQ,CAACY,UAAd;AAA0B;AACtB5B,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKjB,WAAL,CAAiBH,KAAjB;;AACA;AACH;;AACD,aAAKgB,QAAQ,CAACG,cAAd;AAA8B;AAC1BnB,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKC,iBAAL,CAAuBQ,cAAc,CAAC,MAAKpC,KAAL,CAAWK,OAAZ,EAAqB,MAAKG,KAAL,CAAWW,gBAAhC,CAArC;;AACA;AACH;;AACD,aAAKI,QAAQ,CAACM,YAAd;AAA4B;AACxBtB,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKC,iBAAL,CAAuBS,cAAc,CAAC,MAAKrC,KAAL,CAAWK,OAAZ,EAAqB,MAAKG,KAAL,CAAWW,gBAAhC,CAArC;;AACA;AACH;;AACD,aAAKI,QAAQ,CAACe,QAAd;AAAwB;AACpB/B,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKC,iBAAL,CAAuB,MAAK5B,KAAL,CAAWK,OAAX,CAAmB,CAAnB,CAAvB;;AACA;AACH;;AACD,aAAKkB,QAAQ,CAACgB,OAAd;AAAuB;AACnBhC,YAAAA,KAAK,CAACoB,cAAN;;AACA,kBAAKC,iBAAL,CAAuB,MAAK5B,KAAL,CAAWK,OAAX,CAAmB,MAAKL,KAAL,CAAWK,OAAX,CAAmByB,MAAnB,GAA4B,CAA/C,CAAvB;;AACA;AACH;AApCL;AA0CH,KA/ImB;;AAAA,6EAiJK,UAACvB,KAAD,EAAW;AAChC,UAAMiC,IAAI,GAAGC,MAAM,CAACC,YAAP,CAAoBnC,KAAK,CAACoC,QAA1B,CAAb;;AAEA,UAAI7C,cAAc,CAAC8C,IAAf,CAAoBJ,IAApB,CAAJ,EAA+B;AAC3BjC,QAAAA,KAAK,CAACoB,cAAN;;AACA,YAAMT,MAAM,GAAGe,CAAC,CAACC,IAAF,CAAO,MAAKlC,KAAL,CAAWK,OAAlB,EAA2B,UAACwC,CAAD;AAAA,iBAAOZ,CAAC,CAACa,UAAF,CAAaD,CAAC,CAACE,KAAF,CAAQC,WAAR,EAAb,EAAoCR,IAAI,CAACQ,WAAL,EAApC,CAAP;AAAA,SAA3B,CAAf,CAF2B;;;AAK3B,YAAI9B,MAAJ,EAAY;AACR,gBAAKU,iBAAL,CAAuBV,MAAvB;AACH;AACJ;AACJ,KA7JmB;;AAAA,yEA+JC,UAACA,MAAD;AAAA,aAAY,MAAKV,KAAL,CAAWW,gBAAX,KAAgCD,MAAM,CAACZ,KAAnD;AAAA,KA/JD;;AAAA,mEAyLL,YAAM;AAAA,wBAC0B,MAAKN,KAD/B;AAAA,UACTiD,KADS,eACTA,KADS;AAAA,UACFF,KADE,eACFA,KADE;AAAA,UACKG,IADL,eACKA,IADL;AAAA,UACWC,IADX,eACWA,IADX;AAAA,UACiBC,IADjB,eACiBA,IADjB;AAEjB,UAAMC,QAAQ,GAAGH,IAAI,KAAK,OAAT,GACX;AAAEI,QAAAA,YAAY,EAAE,MAAKC;AAArB,OADW,GAEX,EAFN;AAIA,0BACI;AACI,QAAA,IAAI,EAAC,QADT;AAEI,QAAA,EAAE,YAAK,MAAKC,EAAV,YAFN;AAGI,QAAA,GAAG,EAAE,MAAKC,YAHd;AAII,QAAA,OAAO,EAAE,MAAKC;AAJlB,SAKQL,QALR;AAMI,QAAA,SAAS,EAAEJ,KAAK,CAACU,aANrB;AAAA;AAQI,QAAA,SAAS,EAAE,MAAKC,mBARpB;AASI,QAAA,KAAK,EAAER,IAAI,CAACL,KAThB;AAUI,yBAAc,MAVlB;AAWI,yBAAe,MAAKvC,KAAL,CAAWC,QAAX,GAAsB,IAAtB,GAA6B,KAAK,CAXrD;AAAA;AAaI,mCAAkB,MAAK+C,EAAvB;AAbJ,UAeKT,KAAK,iBAAI;AAAM,QAAA,SAAS,EAAEc,UAAE,CAACC,UAAU,CAACb,KAAX,CAAiBc,IAAlB,EAAwBd,KAAK,CAACF,KAA9B;AAAnB,SAA0DA,KAA1D,CAfd,EAgBKI,IAAI,iBAAI,oBAAC,IAAD;AAAM,QAAA,IAAI,6BAAsBA,IAAtB,CAAV;AAAwC,QAAA,IAAI,EAAC;AAA7C,QAhBb,CADJ;AAoBH,KAnNmB;;AAAA,qEAqNH;AAAA,0BACb;AACI,QAAA,EAAE,YAAK,MAAKK,EAAV,cADN;AAEI,QAAA,SAAS,EAAE,MAAKxD,KAAL,CAAWiD,KAAX,CAAiBe,KAFhC;AAGI,QAAA,GAAG,EAAE,MAAKC,cAHd;AAII,QAAA,SAAS,EAAE,MAAKC,qBAJpB;AAAA;AAMI,QAAA,UAAU,EAAE,MAAKC,sBANrB;AAOI,QAAA,QAAQ,EAAE,CAAC,CAPf;AAQI,QAAA,IAAI,EAAC,MART;AASI,iCAAuB,MAAK3D,KAAL,CAAWC,QAAX,aAAyB,MAAK+C,EAA9B,qBAA2C,MAAKhD,KAAL,CAAWW,gBAAtD,IAA2E,KAAK,CAT3G;AAAA;AAWI,qCAAoB,MAAKqC,EAAzB;AAXJ,SAaKvB,CAAC,CAACmC,GAAF,CAAM,MAAKpE,KAAL,CAAWK,OAAjB,EAA0B,MAAKgE,YAA/B,CAbL,CADa;AAAA,KArNG;;AAAA,mEAuOL,UAACnD,MAAD,EAAY;AACvB,UAAMC,gBAAgB,GAAG,MAAKmD,kBAAL,CAAwBpD,MAAxB,CAAzB;;AADuB,UAEfE,IAFe,GAEoBF,MAFpB,CAEfE,IAFe;AAAA,UAET2B,KAFS,GAEoB7B,MAFpB,CAET6B,KAFS;AAAA,UAEFzC,KAFE,GAEoBY,MAFpB,CAEFZ,KAFE;AAAA,UAEKiE,EAFL,GAEoBrD,MAFpB,CAEKqD,EAFL;AAAA,UAESlD,MAFT,GAEoBH,MAFpB,CAESG,MAFT;AAGvB,UAAMmD,WAAW,GAAGnD,MAAM,IAAIY,CAAC,CAACwC,IAAhC;AACA,UAAIC,OAAO,GAAG,KAAK,CAAnB;;AAEA,UAAItD,IAAI,KAAK,QAAb,EAAuB;AACnBsD,QAAAA,OAAO,gBACH;AACI,UAAA,IAAI,EAAC,QADT;AAEI,UAAA,SAAS,EAAE,MAAK1E,KAAL,CAAWiD,KAAX,CAAiB0B,aAFhC;AAGI,UAAA,QAAQ,EAAE,CAAC,CAHf;AAII,UAAA,OAAO,EAAEH,WAJb;AAKI,UAAA,SAAS,EAAE,MAAK9D,WALpB;AAMI,UAAA,IAAI,EAAC;AANT,WAQKqC,KARL,CADJ;AAYH,OAbD,MAaO,IAAI3B,IAAI,KAAK,MAAT,IAAmBA,IAAI,KAAK,SAAhC,EAA2C;AAC9CsD,QAAAA,OAAO,gBACH,oBAAC,IAAD;AACI,UAAA,KAAK,EAAE,MAAKE,SADhB;AAEI,UAAA,QAAQ,EAAExD,IAAI,KAAK,SAFvB;AAGI,UAAA,IAAI,EAAEd,KAHV;AAII,UAAA,EAAE,EAAEiE,EAJR;AAKI,UAAA,QAAQ,EAAE,CAAC,CALf;AAMI,UAAA,SAAS,EAAE,MAAK7D,WANpB;AAOI,UAAA,OAAO,EAAE8D,WAPb;AAQI,UAAA,IAAI,EAAC;AART,WAUKzB,KAVL,CADJ;AAcH;;AAED,0BACI;AACI,QAAA,GAAG,EAAEzC,KADT;AAEI,QAAA,EAAE,YAAK,MAAKkD,EAAV,qBAAuBlD,KAAvB,CAFN;AAGI,QAAA,SAAS,EAAEuD,UAAE,CACT,MAAK7D,KAAL,CAAWiD,KAAX,CAAiB/B,MADR,EAETC,gBAAgB,IAAI,MAAKnB,KAAL,CAAWiD,KAAX,CAAiB4B,OAF5B,CAHjB;AAOI,QAAA,IAAI,EAAC;AAPT,SASKH,OATL,CADJ;AAaH,KAxRmB;;AAGhB,UAAKlE,KAAL,GAAa;AACTC,MAAAA,QAAQ,EAAE,KADD;AAETU,MAAAA,gBAAgB,EAAE,MAAK2D,cAAL;AAFT,KAAb;AAKA,UAAKtB,EAAL,GAAU,MAAKxD,KAAL,CAAWwD,EAAX,IAAiBvB,CAAC,CAAC8C,QAAF,CAAW,SAAX,CAA3B;AACA,UAAKH,SAAL,GAAiB;AAAEI,MAAAA,IAAI,EAAE,MAAKhF,KAAL,CAAWiD,KAAX,CAAiB0B;AAAzB,KAAjB;AATgB;AAUnB;;AAjDL;AAAA;AAAA,6BAwMc;AAAA,yBACyB,KAAK3E,KAD9B;AAAA,UACEiD,KADF,gBACEA,KADF;AAAA,UACSF,KADT,gBACSA,KADT;AAAA,UACgBG,IADhB,gBACgBA,IADhB;AAEN,UAAMG,QAAQ,GAAGH,IAAI,KAAK,OAAT,GACX;AAAE+B,QAAAA,YAAY,EAAE,KAAKC;AAArB,OADW,GAEX,EAFN;AAIA,0BACI,oBAAC,SAAD;AAAW,QAAA,cAAc,EAAE,KAAKxE;AAAhC,sBACI;AACI,QAAA,EAAE,EAAE,KAAK8C,EADb;AAEI,QAAA,SAAS,EAAEK,UAAE,CACTZ,KAAK,CAACkC,IADG,EAET,KAAK3E,KAAL,CAAWC,QAAX,IAAuBwC,KAAK,CAACxC,QAFpB,EAGT,CAACsC,KAAD,IAAUG,IAAI,KAAK,OAAnB,IAA8BD,KAAK,CAACmC,QAH3B;AAFjB,SAOQ/B,QAPR,GASK,KAAKgC,YAAL,EATL,EAUK,KAAKC,cAAL,EAVL,CADJ,CADJ;AAgBH;AA9NL;;AAAA;AAAA,EAA0BC,SAA1B;;gBAAaxF,mBACU;AACfyD,EAAAA,EAAE,EAAEgC,SAAS,CAACC,MADC;AAEfpF,EAAAA,OAAO,EAAEmF,SAAS,CAACE,OAAV,CAAkBF,SAAS,CAACG,KAAV,CAAgB;AACvCrF,IAAAA,KAAK,EAAEkF,SAAS,CAACC,MADsB;AAEvC1C,IAAAA,KAAK,EAAEyC,SAAS,CAACC,MAFsB;AAGvCpE,IAAAA,MAAM,EAAEmE,SAAS,CAACI,IAHqB;AAIvCxE,IAAAA,IAAI,EAAEoE,SAAS,CAACK,KAAV,CAAgB,CAAC,MAAD,EAAS,SAAT,EAAoB,QAApB,CAAhB,CAJiC;AAKvCtB,IAAAA,EAAE,EAAEiB,SAAS,CAACI,IALyB;AAMvCE,IAAAA,OAAO,EAAEN,SAAS,CAACI;AANoB,GAAhB,CAAlB,CAFM;AAUf7C,EAAAA,KAAK,EAAEyC,SAAS,CAACC,MAVF;AAWftC,EAAAA,IAAI,EAAEqC,SAAS,CAACC,MAXD;AAYfzE,EAAAA,MAAM,EAAEwE,SAAS,CAACI,IAZH;AAaf3E,EAAAA,OAAO,EAAEuE,SAAS,CAACI,IAbJ;AAcf1C,EAAAA,IAAI,EAAEsC,SAAS,CAACK,KAAV,CAAgB,CAAC,OAAD,EAAU,OAAV,CAAhB,CAdS;AAef5C,EAAAA,KAAK,EAAEuC,SAAS,CAACO,MAfF;AAgBf3C,EAAAA,IAAI,EAAEoC,SAAS,CAACG,KAAV,CAAgB;AAClB;AACZ;AACA;AACY5C,IAAAA,KAAK,EAAEyC,SAAS,CAACC;AAJC,GAAhB;AAhBS;;gBADV1F,sBAyBa;AAClByD,EAAAA,EAAE,EAAE,KAAK,CADS;AAElBnD,EAAAA,OAAO,EAAE,EAFS;AAGlB8C,EAAAA,IAAI,EAAE,WAHY;AAIlBJ,EAAAA,KAAK,EAAE,KAAK,CAJM;AAKlB/B,EAAAA,MAAM,EAAEiB,CAAC,CAACwC,IALQ;AAMlBxD,EAAAA,OAAO,EAAEgB,CAAC,CAACwC,IANO;AAOlBvB,EAAAA,IAAI,EAAE,OAPY;AAQlBD,EAAAA,KAAK,EAAE+C,YARW;AASlB5C,EAAAA,IAAI,EAAE;AACFL,IAAAA,KAAK,EAAE;AADL;AATY;;AAyS1BhD,IAAI,CAACkD,KAAL,GAAa+C,YAAb;;;;;"}